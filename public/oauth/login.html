<!doctype html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Battle.net sign-in</title>
<style>
*{box-sizing:border-box}html,body{height:100%}body{margin:0;background:radial-gradient(1200px 600px at 20% 10%,#0b1730,#070b15 65%);color:#e5e7eb;font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Arial}
.container{max-width:720px;margin:8vh auto;padding:24px}
.card{background:linear-gradient(180deg,#111827cc,#0b1324cc);border:1px solid #1f2937;border-radius:16px;overflow:hidden;box-shadow:0 10px 40px #0006}
.header{padding:22px 22px 10px;border-bottom:1px solid #1f2937}
.title{margin:0;font-size:20px;display:flex;gap:10px;align-items:center}
.dot{width:10px;height:10px;border-radius:999px;background:#60a5fa;box-shadow:0 0 20px #60a5fa55}
.sub{margin:6px 0 0;color:#9ca3af;font-size:14px}
.body{padding:22px}
.btn{appearance:none;border:1px solid #2563eb;background:linear-gradient(180deg,#3b82f6,#2563eb);color:#fff;padding:12px 16px;border-radius:12px;font-weight:700;cursor:pointer;transition:transform .08s ease,box-shadow .2s ease;box-shadow:0 8px 24px #3b82f644;text-decoration:none;display:inline-flex;align-items:center;gap:8px}
.btn:disabled{opacity:.6;cursor:not-allowed}
.btn.secondary{background:none;color:#e5e7eb;border-color:#334155;box-shadow:none}
.row{margin:12px 0}
.hint{color:#9ca3af;font-size:13px}
.spinner{width:28px;height:28px;border:3px solid #60a5fa33;border-top-color:#60a5fa;border-radius:999px;animation:spin 1s linear infinite;margin-right:10px}
.flex{display:flex;align-items:center;gap:10px}
@keyframes spin{to{transform:rotate(360deg)}}
.small{font-size:12px;color:#94a3b8}
</style>
<body>
<div class="container"><div class="card">
  <div class="header">
    <h1 class="title"><span class="dot"></span>Battle.net sign-in</h1>
    <p class="sub">Continue to authenticate with Blizzard</p>
  </div>
  <div class="body">
    <div class="row flex"><div class="spinner" id="autoSpin" style="display:none"></div><div id="msg">Ready to continue</div></div>
    <div class="row"><button id="go" class="btn">Continue</button> <a class="btn secondary" href="/">Cancel</a></div>
    <div class="row small">You’ll be redirected to Battle.net and then sent back here to choose your character.</div>
  </div>
</div></div>

<script>
const params = new URLSearchParams(location.search);
const state  = params.get("state") || "";
const clientId = "5263abec98844e65a65295d8fee46f91";
const redirect = "https://auth.mikumiku.dev/public/oauth/callback.html";

function start(){
  if(!state){ document.getElementById("msg").textContent="Missing state. Start again from Discord."; return; }
  const q = new URLSearchParams({
    client_id: clientId,
    scope: "openid wow.profile",
    redirect_uri: redirect,
    response_type: "code",
    state
  });
  location.href = "https://oauth.battle.net/authorize?" + q.toString();
}

document.getElementById("go").addEventListener("click", start);
if(state){
  document.getElementById("autoSpin").style.display="inline-block";
  document.getElementById("msg").textContent="Redirecting to Battle.net…";
  start();
}
</script>
</body>
</html>
