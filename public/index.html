<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Miku.dev | Home</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <link rel="stylesheet" href="/styles.css"/>
    <style>
      .backdrop{position:fixed;inset:0;background:rgba(0,0,0,.6);opacity:0;visibility:hidden;transition:opacity .2s ease;z-index:1000}
      .backdrop.active{opacity:1;visibility:visible}
      .modal-description{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(.98);max-width:640px;width:90%;background:#111;color:#fff;padding:1rem 1.25rem;border-radius:14px;box-shadow:0 20px 60px rgba(0,0,0,.5);z-index:1001;opacity:0;pointer-events:none;transition:opacity .2s ease,transform .2s ease}
      .modal-description.active{opacity:1;transform:translate(-50%,-50%) scale(1);pointer-events:auto}
      body.modal-open{overflow:hidden}
      .modal-description h4{margin:0 0 .5rem 0}
    </style>
  </head>
  <body>
    <canvas id="soundWaveCanvas" aria-hidden="true"></canvas>
    <div class="page-container" id="pageContainer">
      <header class="title-bar" id="titleBar">
        <div class="container">
          <div class="left-section"></div>
          <div class="title-wrapper">
            <a href="/" aria-label="Home" class="logo-link">
              <span class="site-title">Miku.dev</span>
              <div class="visualizer-wrapper">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 150 100" class="visualizer">
                  <g>
                    <rect x="10" y="70" width="15" height="30" fill="#00c6ff">
                      <animate attributeName="height" values="30;60;30" dur="0.8s" repeatCount="indefinite"/>
                      <animate attributeName="y" values="70;40;70" dur="0.8s" repeatCount="indefinite"/>
                    </rect>
                    <rect x="35" y="60" width="15" height="40" fill="#ff4081">
                      <animate attributeName="height" values="40;80;40" dur="1s" repeatCount="indefinite"/>
                      <animate attributeName="y" values="60;20;60" dur="1s" repeatCount="indefinite"/>
                    </rect>
                    <rect x="60" y="80" width="15" height="20" fill="#00c6ff">
                      <animate attributeName="height" values="20;50;20" dur="0.6s" repeatCount="indefinite"/>
                      <animate attributeName="y" values="80;50;80" dur="0.6s" repeatCount="indefinite"/>
                    </rect>
                    <rect x="85" y="50" width="15" height="50" fill="#ff4081">
                      <animate attributeName="height" values="50;90;50" dur="1.2s" repeatCount="indefinite"/>
                      <animate attributeName="y" values="50;10;50" dur="1.2s" repeatCount="indefinite"/>
                    </rect>
                    <rect x="110" y="70" width="15" height="30" fill="#00c6ff">
                      <animate attributeName="height" values="30;60;30" dur="0.9s" repeatCount="indefinite"/>
                      <animate attributeName="y" values="70;40;70" dur="0.9s" repeatCount="indefinite"/>
                    </rect>
                    <rect x="135" y="60" width="15" height="40" fill="#ff4081">
                      <animate attributeName="height" values="40;80;40" dur="1.1s" repeatCount="indefinite"/>
                      <animate attributeName="y" values="60;20;60" dur="1.1s" repeatCount="indefinite"/>
                    </rect>
                  </g>
                </svg>
              </div>
            </a>
          </div>
          <div class="right-section">
            <button class="menu-button" id="menuButton" aria-label="Open Menu">
              <i class="fas fa-music"></i>
            </button>
          </div>
        </div>
      </header>
      <nav class="overlay-menu" id="overlayMenu">
        <button class="close-overlay" id="closeOverlay" aria-label="Close Menu">
          <i class="fas fa-times"></i>
        </button>
        <div class="overlay-content">
          <a href="/auth" aria-label="Admin Login"><i class="fas fa-user-lock"></i> Admin Login</a>
          <a href="#aboutMe" aria-label="About Me"><i class="fas fa-info-circle"></i> About Me</a>
          <div class="personality-options">
            <button id="personalityOption1" class="personality-button"><i class="fas fa-music"></i> Melody</button>
            <button id="personalityOption2" class="personality-button"><i class="fas fa-headphones"></i> Harmony</button>
            <button id="personalityOption3" class="personality-button"><i class="fas fa-microphone"></i> Rhythm</button>
          </div>
        </div>
      </nav>
      <section class="now-playing-container">
        <div class="now-playing-card" id="nowPlayingCard">
          <div class="now-playing-grid">
            <div class="video-info">
              <div class="info-item"><i class="fas fa-tv"></i><span id="channelName">Loading…</span></div>
              <div class="info-item"><i class="fas fa-eye"></i><span id="viewCount">Loading…</span></div>
              <div class="info-item"><i class="fas fa-thumbs-up"></i><span id="likeCount">Loading…</span></div>
              <div class="info-item"><i class="fas fa-calendar-day"></i><span id="publishedDate">Loading…</span></div>
              <div class="info-item"><i class="fas fa-tag"></i><span id="videoCategory">Loading…</span></div>
            </div>
            <div class="time-info">
              <div class="greeting-container">
                <p class="greeting"><i class="fas fa-sun"></i> <span id="greeting-text">Good Morning!</span></p>
              </div>
              <div class="clock-container">
                <div class="digital-clock">
                  <p id="local-time"><i class="fas fa-clock"></i> 00:00:00</p>
                  <p id="current-date"><i class="fas fa-calendar-alt"></i> 1 January 2025</p>
                  <p id="day-of-week"><i class="fas fa-calendar-day"></i> Wednesday</p>
                  <p id="time-zone"><i class="fas fa-globe"></i> UTC</p>
                </div>
              </div>
            </div>
            <div class="youtube-section" id="youtubeSection" style="position: relative;">
              <div class="video-thumb">
                <img id="videoThumbnailImage" src="" alt="Thumbnail" loading="lazy"/>
              </div>
              <div class="video-details">
                <h3>Currently Playing</h3>
                <p id="videoTitle">Loading…</p>
                <div class="progress-bar"><div id="progressBar"></div></div>
                <button id="toggleDescriptionButton">Show Description</button>
                <div id="backdrop" class="backdrop" aria-hidden="true"></div>
                <div id="descriptionModal" class="modal-description" role="dialog" aria-modal="true" aria-labelledby="descriptionModalTitle" aria-describedby="descriptionModalDescription">
                  <h4 id="descriptionModalTitle">Description</h4>
                  <p id="descriptionModalDescription">Loading description…</p>
                </div>
              </div>
              <div class="status-boxes">
                <div id="liveIndicator" class="status-box live">Live</div>
                <div id="pauseIndicator" class="status-box paused">Paused</div>
              </div>
            </div>
            <aside class="weather-info" style="grid-area: weatherSection;">
              <img id="weather-icon" src="" alt="Weather Icon" loading="lazy"/>
              <p id="weather-description">Loading…</p>
              <p id="temperature">--°C</p>
              <p id="humidity">Humidity: --%</p>
              <p id="wind-speed">Wind: -- m/s</p>
            </aside>
          </div>
          <div id="offline-indicator" class="offline-indicator"><i class="fas fa-signal-slash"></i> Offline</div>
        </div>
      </section>
      <footer class="footer">
        <div class="container">
          <p>&copy; 2024 MikuMiku. All rights reserved.</p>
          <button id="manageConsentFooter" class="manage-consent-button"><i class="fas fa-cookie-bite"></i> Manage Cookie Preferences</button>
        </div>
      </footer>
      <div id="consentModal" class="modal" aria-hidden="true" role="dialog" aria-labelledby="consentModalTitle" aria-describedby="consentModalDescription">
        <div class="modal-content">
          <button class="close-button" id="closeConsentModal" aria-label="Close Consent Modal"><i class="fas fa-times"></i></button>
          <h2 id="consentModalTitle"><i class="fas fa-cookie"></i> Cookie Consent</h2>
          <p id="consentModalDescription">I use cookies stored in your browser to enhance your experience on my personal website. These cookies are essential for the website's functionality. By clicking "Accept," you consent to their use. You can also manage your cookie preferences in the "Manage Cookie Preferences" section.</p>
          <div class="consent-buttons">
            <button id="acceptConsent" class="consent-button"><i class="fas fa-check"></i> Accept</button>
            <button id="declineConsent" class="consent-button"><i class="fas fa-times"></i> Decline</button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.1/socket.io.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="haru.js"></script>
    <script src="clockwork.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("pageContainer");e&&e.classList.add("loaded");const t=document.getElementById("titleBar");t&&window.addEventListener("scroll",function(){t.classList.toggle("scrolled",window.scrollY>50)});const n=document.getElementById("menuButton"),o=document.getElementById("overlayMenu"),a=document.getElementById("closeOverlay");n&&o&&n.addEventListener("click",function(e){e.stopPropagation(),o.classList.add("active"),document.body.classList.add("overlay-active")}),a&&o&&a.addEventListener("click",function(e){e.stopPropagation(),o.classList.remove("active"),document.body.classList.remove("overlay-active")}),window.addEventListener("click",function(e){e.target===o&&(o.classList.remove("active"),document.body.classList.remove("overlay-active"))});const i=document.querySelectorAll(".personality-button"),d=document.querySelector(".site-title");i.length&&d&&i.forEach(e=>{e.addEventListener("click",function(){const t=e.textContent.trim();"Melody"===t?d.style.color="#ff4081":"Harmony"===t?d.style.color="#00c6ff":"Rhythm"===t?d.style.color="#ffffff":d.style.color="#00c6ff",i.forEach(e=>e.classList.remove("active")),e.classList.add("active")})})});
    </script>

    <script>
      (function(){const e={consentCookieName:"cookieConsent",consentCookieExpiryDays:365,consentCookiePath:"/",consentModalId:"consentModal",acceptButtonId:"acceptConsent",declineButtonId:"declineConsent",manageButtonIds:["manageConsentFooter"],closeButtonId:"closeConsentModal",cookieCategories:{necessary:{enabled:true,description:"Necessary cookies enable core functionalities and security features of the website."}},focusableSelectors:"button, [href], input, select, textarea, [tabindex]:not([tabindex='-1'])"};const t=document.getElementById(e.consentModalId),n=document.getElementById(e.acceptButtonId),o=document.getElementById(e.declineButtonId),a=document.getElementById(e.closeButtonId),c=e.manageButtonIds.map(e=>document.getElementById(e));function s(t,n,o,a){let c="";if(n){const e=new Date;e.setTime(e.getTime()+24*n*60*60*1e3),c="; expires="+e.toUTCString()}const s="https:"===location.protocol?"; Secure":"",l="; SameSite=Lax";document.cookie=t+"="+(o||"")+c+"; path="+a+s+l}function l(e){const t=e+"=",n=document.cookie.split(";");for(let e=0;e<n.length;e++){let o=n[e].trim();if(0===o.indexOf(t))return o.substring(t.length)}return null}function r(e){document.cookie=e+"=; Max-Age=-99999999; path=/;"}function d(e){const n=e.querySelectorAll(u),o=n.length?n[0]:null,a=n.length?n[n.length-1]:null;e.addEventListener("keydown",function(e){"Tab"===e.key&&(e.shiftKey?document.activeElement===o&&(e.preventDefault(),a.focus()):document.activeElement===a&&(e.preventDefault(),o.focus())),"Escape"===e.key&&e.preventDefault()})}function m(){t.classList.add("active"),document.body.classList.add("modal-active"),t.setAttribute("aria-hidden","false");const e=t.querySelectorAll(u);e.length&&e[0].focus(),d(t)}function g(){t.classList.remove("active"),document.body.classList.remove("modal-active"),t.setAttribute("aria-hidden","true")}function f(){const t=l(e.consentCookieName);t?v(t):m(),n&&n.addEventListener("click",function(){s(e.consentCookieName,JSON.stringify({necessary:true}),e.consentCookieExpiryDays,e.consentCookiePath),g(),h()}),o&&o.addEventListener("click",function(){s(e.consentCookieName,JSON.stringify({necessary:false}),e.consentCookieExpiryDays,e.consentCookiePath),g(),p()}),c.forEach(e=>{e&&e.addEventListener("click",function(e){e.preventDefault(),m()})}),a&&a.addEventListener("click",function(){alert("Please make a choice regarding cookie usage.")}),window.addEventListener("click",function(e){e.target===t&&alert("Please make a choice regarding cookie usage.")})}function v(t){try{const n=JSON.parse(t);n.necessary?h(n):p()}catch(e){m()}}function h(e){}function p(){}function y(){const t="test_cookie_consent";s(t,"test",1,"/");const n="test"===l(t);return r(t),n}document.addEventListener("DOMContentLoaded",function(){y()?f():console.warn("Cookies are disabled in this browser. Consent modal will not be displayed.")});const u=e.focusableSelectors})();
    </script>

    <script>
      document.addEventListener("DOMContentLoaded",function(){const e=localStorage.getItem("currentVideoTitle"),t=localStorage.getItem("currentVideoThumbnail");if(e){const t=document.getElementById("videoTitle");t&&(t.textContent=e)}if(t){const e=document.getElementById("videoThumbnailImage");e&&(e.src=t,e.style.display="block")}const n=localStorage.getItem("currentVideoChannel"),o=localStorage.getItem("currentVideoViews"),a=localStorage.getItem("currentVideoLikes"),i=localStorage.getItem("currentVideoPublished"),d=localStorage.getItem("currentVideoCategory"),l=localStorage.getItem("currentVideoDescription"),c=document.getElementById("channelName"),s=document.getElementById("viewCount"),r=document.getElementById("likeCount"),m=document.getElementById("publishedDate"),g=document.getElementById("videoCategory"),f=document.getElementById("descriptionModalDescription");c&&n&&(c.textContent=n),s&&o&&(s.textContent=o),r&&a&&(r.textContent=a),m&&i&&(m.textContent=i),g&&d&&(g.textContent=d),f&&l&&(f.textContent=l)});
    </script>

    <script>
      document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("toggleDescriptionButton"),t=document.getElementById("descriptionModal"),n=document.getElementById("backdrop");function o(){t.classList.add("active"),n.classList.add("active"),document.body.classList.add("modal-open"),localStorage.setItem("descriptionModalOpen","true")}function a(){t.classList.remove("active"),n.classList.remove("active"),document.body.classList.remove("modal-open"),localStorage.setItem("descriptionModalOpen","false")}if(localStorage.getItem("descriptionModalOpen")==="true"){o()}else{a()}e.addEventListener("click",function(){t.classList.contains("active")?a():o()});n.addEventListener("click",a);document.addEventListener("keydown",function(e){if(e.key==="Escape"&&t.classList.contains("active"))a()})});
    </script>

    <script>
      document.addEventListener("DOMContentLoaded",function(){function e(){const e=new Date,t=e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),n=document.getElementById("local-time");n&&(n.textContent=t);const o=e.toLocaleDateString(void 0,{day:"2-digit",month:"long",year:"numeric"}),a=document.getElementById("current-date");a&&(a.textContent=o);const i=e.toLocaleDateString(void 0,{weekday:"long"}),d=document.getElementById("day-of-week");d&&(d.textContent=i)}setInterval(e,1e3),e()});
    </script>

    <script>
      document.addEventListener("DOMContentLoaded",function(){async function e(){try{const e=await fetch("/api/weather?city="+encodeURIComponent("Leeds")),t=await e.json();if(t.error)throw new Error(t.error);n(t)}catch(e){const t=document.getElementById("weather-icon");t&&(t.style.display="none");const n=document.getElementById("weather-description");n&&(n.innerText="Unable to fetch weather data.")}}function n(e){const n=e.weather[0].description,o=Math.round(e.main.temp),a=e.main.humidity,i=e.wind.speed,d=e.weather[0].icon,l="https://openweathermap.org/img/wn/"+d+"@2x.png";document.getElementById("weather-description").innerText="Condition: "+n,document.getElementById("temperature").innerText="Temperature: "+o+"°C",document.getElementById("humidity").innerText="Humidity: "+a+"%",document.getElementById("wind-speed").innerText="Wind: "+i+" m/s";const c=document.getElementById("weather-icon");c&&(c.src=l,c.style.display="block")}setInterval(e,3600000),e()});
    </script>

    <script>
      document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("soundWaveCanvas"),t=e.getContext("2d");function n(){e.width=window.innerWidth,e.height=window.innerHeight}n(),window.addEventListener("resize",function(){n(),m=Math.floor(e.width/d),g=new Array(m).fill(0),h=Array.from({length:m},()=>Math.random()*.05+.05),p=new Array(m).fill(0),v=new Array(m).fill("0")});const d=20;let m=Math.floor(e.width/d),g=new Array(m).fill(0),h=Array.from({length:m},()=>Math.random()*.05+.05),p=new Array(m).fill(0),v=new Array(m).fill("0");const o="01",a=["#00C6FF","#ff4081"],i=["Hatsune Miku","The First Sound of the Future","39","Digital Diva","CV01","01"];function l(e,t){const n=parseInt(e.slice(1,3),16),o=parseInt(e.slice(3,5),16),a=parseInt(e.slice(5,7),16);return"rgba("+n+", "+o+", "+a+", "+t+")"}function c(){t.fillStyle="rgba(0, 0, 0, 0.05)",t.fillRect(0,0,e.width,e.height),t.font=d+"px monospace",t.shadowColor="rgba(0, 0, 0, 0.8)",t.shadowBlur=4;const n=6;for(let s=0;s<g.length;s++){let r=h[s];let u;if(p[s]>0)r=0,p[s]--;if(0===p[s]&&Math.random()<.002){u=i[Math.floor(Math.random()*i.length)],t.fillStyle="#FF69B4",p[s]=180,r=.2*h[s]}else{Math.random()<.1&&(v[s]=o.charAt(Math.floor(Math.random()*o.length))),u=v[s],t.fillStyle=a[s%a.length]}const w=s*d,f=Math.floor(g[s])*d;t.fillText(u,w,f);for(let e=1;e<n;e++){const n=f-e*d;if(n<0)break;const i=1-e/n;t.fillStyle=l(a[s%a.length],i),t.fillText(o.charAt(Math.floor(Math.random()*o.length)),w,n)}f>e.height&&Math.random()>.995&&(g[s]=0,h[s]=Math.random()*.05+.05,p[s]=0,v[s]="0"),g[s]+=r}requestAnimationFrame(c)}c()});
    </script>

    <script>
      document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("nowPlayingCard"),t=document.getElementById("youtubeSection"),n=document.getElementById("offline-indicator"),o=document.getElementById("videoTitle"),a=document.getElementById("videoThumbnailImage"),i=document.getElementById("channelName"),d=document.getElementById("viewCount"),l=document.getElementById("likeCount"),c=document.getElementById("publishedDate"),s=document.getElementById("videoCategory"),r=document.getElementById("progressBar"),m=document.getElementById("liveIndicator"),g=document.getElementById("pauseIndicator"),f=document.getElementById("descriptionModalDescription"),v=document.getElementById("toggleDescriptionButton");let h=null;let p=null;function y(e){return e==null?null:Number(e)}function u(e){return e===true||e==="true"||e===1||e==="1"}function w(e){if(!r)return;const t=u(e.isLive);if(t){r.style.width="100%";return}const n=y(e.duration),o=y(e.currentTime),a=y(e.percent);if(typeof n==="number"&&n>0&&typeof o==="number"&&o>=0){const e=Math.max(0,Math.min(100,(o/n)*100));r.style.width=e+"%";p=e}else if(typeof a==="number"&&!isNaN(a)){const e=Math.max(0,Math.min(100,a));r.style.width=e+"%";p=e}else if(p==null){r.style.width="0%"}}
function S(e){const t=u(e.isLive),n=u(e.isPaused);m&&m.classList.toggle("active",t),g&&g.classList.toggle("active",n)}
function E(){n&&n.classList.remove("visible"),e&&e.classList.remove("offline"),t&&(t.style.display="block")}
function b(e){h=e.videoId||null,o&&(o.textContent=e.title||""),i&&(i.textContent=e.channelTitle||""),d&&(d.textContent=A(e.viewCount)),l&&(l.textContent=A(e.likeCount)),c&&(c.textContent=e.publishedAt?new Date(e.publishedAt).toLocaleDateString():c.textContent),s&&(s.textContent=e.category||""),f&&(f.textContent=e.description||""),a&&(e.thumbnail?(a.removeAttribute("loading"),a.src=e.thumbnail,a.style.display="block"):a.style.display=""),E(),w(e),S(e),v&&(v.style.display="block"),localStorage.setItem("currentVideoTitle",o?o.textContent:""),localStorage.setItem("currentVideoThumbnail",a&&a.src?a.src:""),localStorage.setItem("currentVideoChannel",i?i.textContent:""),localStorage.setItem("currentVideoViews",d?d.textContent:""),localStorage.setItem("currentVideoLikes",l?l.textContent:""),localStorage.setItem("currentVideoPublished",c?c.textContent:""),localStorage.setItem("currentVideoCategory",s?s.textContent:""),localStorage.setItem("currentVideoDescription",f?f.textContent:"")}
function T(e){E(),w(e),S(e)}
function A(e){if(typeof e==="string")e=e.replace(/,/g,"");const t=Number(e);return isNaN(t)?"N/A":t.toLocaleString()}
function C(){n&&n.classList.add("visible"),e&&e.classList.add("offline")}
const L=io();L.on("connect",function(){E()}),L.on("disconnect",function(){C()}),L.on("presenceUpdate",function(e){"offline"===e.presenceType?C():"video"===e.presenceType?(e.videoId===h?T(e):b(e)):"browsing"===e.presenceType?(o&&(o.textContent=e.title||o.textContent),a&&(e.thumbnail?(a.src=e.thumbnail,a.style.display="block"):a.style.display=""),E(),S({isLive:false,isPaused:false})):void 0});setTimeout(function(){if(!o||!o.textContent||o.textContent==="Loading…"){const e=localStorage.getItem("currentVideoTitle");if(e&&o)o.textContent=e}},0)});
    </script>
  </body>
</html>
