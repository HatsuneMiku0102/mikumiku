<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Miku.dev | Home</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <canvas id="soundWaveCanvas" aria-hidden="true"></canvas>
    <div class="page-container" id="pageContainer">
      <header class="title-bar" id="titleBar">
        <div class="container">
          <div class="left-section"></div>
          <div class="title-wrapper">
            <a href="/" aria-label="Home" class="logo-link">
              <span class="site-title">Miku.dev</span>
              <div class="visualizer-wrapper">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 150 100" class="visualizer">
                  <g>
                    <rect x="10" y="70" width="15" height="30" fill="#00c6ff">
                      <animate attributeName="height" values="30;60;30" dur="0.8s" repeatCount="indefinite" />
                      <animate attributeName="y" values="70;40;70" dur="0.8s" repeatCount="indefinite" />
                    </rect>
                    <rect x="35" y="60" width="15" height="40" fill="#ff4081">
                      <animate attributeName="height" values="40;80;40" dur="1s" repeatCount="indefinite" />
                      <animate attributeName="y" values="60;20;60" dur="1s" repeatCount="indefinite" />
                    </rect>
                    <rect x="60" y="80" width="15" height="20" fill="#00c6ff">
                      <animate attributeName="height" values="20;50;20" dur="0.6s" repeatCount="indefinite" />
                      <animate attributeName="y" values="80;50;80" dur="0.6s" repeatCount="indefinite" />
                    </rect>
                    <rect x="85" y="50" width="15" height="50" fill="#ff4081">
                      <animate attributeName="height" values="50;90;50" dur="1.2s" repeatCount="indefinite" />
                      <animate attributeName="y" values="50;10;50" dur="1.2s" repeatCount="indefinite" />
                    </rect>
                    <rect x="110" y="70" width="15" height="30" fill="#00c6ff">
                      <animate attributeName="height" values="30;60;30" dur="0.9s" repeatCount="indefinite" />
                      <animate attributeName="y" values="70;40;70" dur="0.9s" repeatCount="indefinite" />
                    </rect>
                    <rect x="135" y="60" width="15" height="40" fill="#ff4081">
                      <animate attributeName="height" values="40;80;40" dur="1.1s" repeatCount="indefinite" />
                      <animate attributeName="y" values="60;20;60" dur="1.1s" repeatCount="indefinite" />
                    </rect>
                  </g>
                </svg>
              </div>
            </a>
          </div>
          <div class="right-section">
            <button class="menu-button" id="menuButton" aria-label="Open Menu">
              <i class="fas fa-music"></i>
            </button>
          </div>
        </div>
      </header>
      <nav class="overlay-menu" id="overlayMenu">
        <button class="close-overlay" id="closeOverlay" aria-label="Close Menu">
          <i class="fas fa-times"></i>
        </button>
        <div class="overlay-content">
          <a href="/auth" aria-label="Admin Login">
            <i class="fas fa-user-lock"></i> Admin Login
          </a>
          <a href="#aboutMe" aria-label="About Me">
            <i class="fas fa-info-circle"></i> About Me
          </a>
          <div class="personality-options">
            <button id="personalityOption1" class="personality-button">
              <i class="fas fa-music"></i> Melody
            </button>
            <button id="personalityOption2" class="personality-button">
              <i class="fas fa-headphones"></i> Harmony
            </button>
            <button id="personalityOption3" class="personality-button">
              <i class="fas fa-microphone"></i> Rhythm
            </button>
          </div>
        </div>
      </nav>
      <section class="now-playing-container">
        <div class="now-playing-card">
          <div class="now-playing-grid">
            <div class="video-info">
              <div class="info-item"><i class="fas fa-tv"></i><span id="channelName">Loading…</span></div>
              <div class="info-item"><i class="fas fa-eye"></i><span id="viewCount">Loading…</span></div>
              <div class="info-item"><i class="fas fa-thumbs-up"></i><span id="likeCount">Loading…</span></div>
              <div class="info-item"><i class="fas fa-calendar-day"></i><span id="publishedDate">Loading…</span></div>
              <div class="info-item"><i class="fas fa-tag"></i><span id="videoCategory">Loading…</span></div>
            </div>
            <div class="time-info">
              <div class="greeting-container">
                <p class="greeting"><i class="fas fa-sun"></i> <span id="greeting-text">Good Morning!</span></p>
              </div>
              <div class="clock-container">
                <div class="digital-clock">
                  <p id="local-time"><i class="fas fa-clock"></i> 00:00:00</p>
                  <p id="current-date"><i class="fas fa-calendar-alt"></i> 1 January 2025</p>
                  <p id="day-of-week"><i class="fas fa-calendar-day"></i> Wednesday</p>
                  <p id="time-zone"><i class="fas fa-globe"></i> UTC</p>
                </div>
              </div>
            </div>
            <div class="youtube-section" id="youtubeSection" style="position: relative;">
              <div class="video-thumb">
                <img id="videoThumbnailImage" src="" alt="Thumbnail" loading="lazy"/>
              </div>
              <div class="video-details">
                <h3>Currently Playing</h3>
                <p id="videoTitle">Loading…</p>
                <div class="progress-bar">
                  <div id="progressBar"></div>
                </div>
                <button id="toggleDescriptionButton">Show Description</button>
                <div id="descriptionModal" class="modal-description">
                  <h4 id="descriptionModalTitle">Description</h4>
                  <p id="descriptionModalDescription">Loading description…</p>
                </div>
              </div>
              <div class="status-boxes">
                <div id="liveIndicator" class="status-box live">Live</div>
                <div id="pauseIndicator" class="status-box paused">Paused</div>
              </div>
            </div>
            <aside class="weather-info" style="grid-area: weatherSection;">
              <img id="weather-icon" src="" alt="Weather Icon" loading="lazy"/>
              <p id="weather-description">Loading…</p>
              <p id="temperature">--°C</p>
              <p id="humidity">Humidity: --%</p>
              <p id="wind-speed">Wind: -- m/s</p>
            </aside>
          </div>
          <div id="offline-indicator" class="offline-indicator"><i class="fas fa-signal-slash"></i> Offline</div>
        </div>
      </section>

      <footer class="footer">
        <div class="container">
          <p>&copy; 2024 MikuMiku. All rights reserved.</p>
          <button id="manageConsentFooter" class="manage-consent-button">
            <i class="fas fa-cookie-bite"></i> Manage Cookie Preferences
          </button>
        </div>
      </footer>
      <div id="consentModal" class="modal" aria-hidden="true" role="dialog" aria-labelledby="consentModalTitle" aria-describedby="consentModalDescription">
        <div class="modal-content">
          <button class="close-button" id="closeConsentModal" aria-label="Close Consent Modal">
            <i class="fas fa-times"></i>
          </button>
          <h2 id="consentModalTitle"><i class="fas fa-cookie"></i> Cookie Consent</h2>
          <p id="consentModalDescription">
            I use cookies stored in your browser to enhance your experience on my personal website. These cookies are essential for the website's functionality. By clicking "Accept," you consent to their use. You can also manage your cookie preferences in the "Manage Cookie Preferences" section.
          </p>
          <div class="consent-buttons">
            <button id="acceptConsent" class="consent-button"><i class="fas fa-check"></i> Accept</button>
            <button id="declineConsent" class="consent-button"><i class="fas fa-times"></i> Decline</button>
          </div>
        </div>
      </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.1/socket.io.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="haru.js"></script>
    <script src="clockwork.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        const pageContainer = document.getElementById("pageContainer");
        if (pageContainer) pageContainer.classList.add("loaded");
        const titleBar = document.getElementById("titleBar");
        if (titleBar)
          window.addEventListener("scroll", function() {
            titleBar.classList.toggle("scrolled", window.scrollY > 50);
          });
        const menuButton = document.getElementById("menuButton");
        const overlayMenu = document.getElementById("overlayMenu");
        const closeOverlay = document.getElementById("closeOverlay");
        if (menuButton && overlayMenu)
          menuButton.addEventListener("click", function(e) {
            e.stopPropagation();
            overlayMenu.classList.add("active");
            document.body.classList.add("overlay-active");
          });
        if (closeOverlay && overlayMenu)
          closeOverlay.addEventListener("click", function(e) {
            e.stopPropagation();
            overlayMenu.classList.remove("active");
            document.body.classList.remove("overlay-active");
          });
        window.addEventListener("click", function(event) {
          if (event.target === overlayMenu) {
            overlayMenu.classList.remove("active");
            document.body.classList.remove("overlay-active");
          }
        });
        const personalityButtons = document.querySelectorAll(".personality-button");
        const siteTitle = document.querySelector(".site-title");
        if (personalityButtons.length && siteTitle) {
          personalityButtons.forEach((button) => {
            button.addEventListener("click", function() {
              const personality = button.textContent.trim();
              if (personality === "Melody")
                siteTitle.style.color = "#ff4081";
              else if (personality === "Harmony")
                siteTitle.style.color = "#00c6ff";
              else if (personality === "Rhythm")
                siteTitle.style.color = "#ffffff";
              else siteTitle.style.color = "#00c6ff";
              personalityButtons.forEach((btn) =>
                btn.classList.remove("active")
              );
              button.classList.add("active");
            });
          });
        }
      });
    </script>
    <script>
      (function() {
        "use strict";
        const CONFIG = {
          consentCookieName: "cookieConsent",
          consentCookieExpiryDays: 365,
          consentCookiePath: "/",
          consentModalId: "consentModal",
          acceptButtonId: "acceptConsent",
          declineButtonId: "declineConsent",
          manageButtonIds: ["manageConsentFooter"],
          closeButtonId: "closeConsentModal",
          cookieCategories: {
            necessary: {
              enabled: true,
              description:
                "Necessary cookies enable core functionalities and security features of the website.",
            },
          },
          focusableSelectors:
            "button, [href], input, select, textarea, [tabindex]:not([tabindex='-1'])",
        };
        const consentModal = document.getElementById(CONFIG.consentModalId);
        const acceptButton = document.getElementById(CONFIG.acceptButtonId);
        const declineButton = document.getElementById(CONFIG.declineButtonId);
        const closeButton = document.getElementById(CONFIG.closeButtonId);
        const manageConsentButtons = CONFIG.manageButtonIds.map((id) =>
          document.getElementById(id)
        );
        function setCookie(name, value, days, path) {
          let expires = "";
          if (days) {
            const date = new Date();
            date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);
            expires = "; expires=" + date.toUTCString();
          }
          const secure =
            location.protocol === "https:" ? "; Secure" : "";
          const sameSite = "; SameSite=Lax";
          document.cookie =
            name +
            "=" +
            (value || "") +
            expires +
            "; path=" +
            path +
            secure +
            sameSite;
        }
        function getCookie(name) {
          const nameEQ = name + "=";
          const ca = document.cookie.split(";");
          for (let i = 0; i < ca.length; i++) {
            let c = ca[i].trim();
            if (c.indexOf(nameEQ) === 0)
              return c.substring(nameEQ.length);
          }
          return null;
        }
        function eraseCookie(name, path) {
          document.cookie =
            name + '=; Max-Age=-99999999; path=' + path + ';';
        }
        function trapFocus(modal) {
          const focusableElements = modal.querySelectorAll(
            CONFIG.focusableSelectors
          );
          if (!focusableElements.length) return;
          const firstFocusableElement = focusableElements[0],
            lastFocusableElement =
              focusableElements[focusableElements.length - 1];
          modal.addEventListener("keydown", function(event) {
            if (event.key === "Tab") {
              if (event.shiftKey) {
                if (document.activeElement === firstFocusableElement) {
                  event.preventDefault();
                  lastFocusableElement.focus();
                }
              } else {
                if (document.activeElement === lastFocusableElement) {
                  event.preventDefault();
                  firstFocusableElement.focus();
                }
              }
            }
            if (event.key === "Escape") {
              event.preventDefault();
            }
          });
        }
        function showModal() {
          consentModal.classList.add("active");
          document.body.classList.add("modal-active");
          consentModal.setAttribute("aria-hidden", "false");
          const focusableElements = consentModal.querySelectorAll(
            CONFIG.focusableSelectors
          );
          if (focusableElements.length)
            focusableElements[0].focus();
          trapFocus(consentModal);
        }
        function hideModal() {
          consentModal.classList.remove("active");
          document.body.classList.remove("modal-active");
          consentModal.setAttribute("aria-hidden", "true");
        }
        function initConsentModal() {
          const existingConsent = getCookie(CONFIG.consentCookieName);
          if (!existingConsent) {
            showModal();
          } else {
            applyConsent(existingConsent);
          }
          if (acceptButton) {
            acceptButton.addEventListener("click", function() {
              setCookie(
                CONFIG.consentCookieName,
                JSON.stringify({ necessary: true }),
                CONFIG.consentCookieExpiryDays,
                CONFIG.consentCookiePath
              );
              hideModal();
              initializeCookies();
            });
          }
          if (declineButton) {
            declineButton.addEventListener("click", function() {
              setCookie(
                CONFIG.consentCookieName,
                JSON.stringify({ necessary: false }),
                CONFIG.consentCookieExpiryDays,
                CONFIG.consentCookiePath
              );
              hideModal();
              disableCookies();
            });
          }
          manageConsentButtons.forEach((button) => {
            if (button) {
              button.addEventListener("click", function(event) {
                event.preventDefault();
                showModal();
              });
            }
          });
          if (closeButton) {
            closeButton.addEventListener("click", function() {
              alert("Please make a choice regarding cookie usage.");
            });
          }
          window.addEventListener("click", function(event) {
            if (event.target === consentModal) {
              alert("Please make a choice regarding cookie usage.");
            }
          });
        }
        function applyConsent(consentValue) {
          try {
            const consent = JSON.parse(consentValue);
            if (consent.necessary) {
              initializeCookies(consent);
            } else {
              disableCookies();
            }
          } catch (error) {
            showModal();
          }
        }
        function initializeCookies(consent) {
          console.log("Necessary cookies enabled.");
        }
        function disableCookies() {
          console.log("Necessary cookies disabled.");
        }
        function areCookiesEnabled() {
          const testCookie = "test_cookie_consent";
          setCookie(testCookie, "test", 1, CONFIG.consentCookiePath);
          const result = getCookie(testCookie) === "test";
          eraseCookie(testCookie, CONFIG.consentCookiePath);
          return result;
        }
        function init() {
          if (areCookiesEnabled()) {
            initConsentModal();
          } else {
            console.warn(
              "Cookies are disabled in this browser. Consent modal will not be displayed."
            );
          }
        }
        document.addEventListener("DOMContentLoaded", init);
      })();
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        // Restore stored video info on page load if available
        const storedTitle = localStorage.getItem("currentVideoTitle");
        const storedThumbnail = localStorage.getItem("currentVideoThumbnail");
        if(storedTitle) {
          const videoTitleElement = document.getElementById("videoTitle");
          if(videoTitleElement) videoTitleElement.textContent = storedTitle;
        }
        if(storedThumbnail) {
          const videoThumbnailImage = document.getElementById("videoThumbnailImage");
          if(videoThumbnailImage) {
            videoThumbnailImage.src = storedThumbnail;
            videoThumbnailImage.style.display = "block";
          }
        }
      });
    </script>

    <script>
    (function() {
      document.addEventListener("DOMContentLoaded", function() {
        // Elements
        const nowPlayingBox        = document.getElementById("nowPlayingBox");
        const youtubeSection       = document.getElementById("youtubeSection");
        const offlineIndicator     = document.getElementById("offline-indicator");
        const bufferOverlay        = document.getElementById("bufferOverlay");
        const videoTitleEl         = document.getElementById("videoTitle");
        const videoThumbnailEl     = document.getElementById("videoThumbnailImage");
        const channelNameEl        = document.getElementById("channelName");
        const viewCountEl          = document.getElementById("viewCount");
        const likeCountEl          = document.getElementById("likeCount");
        const publishedDateEl      = document.getElementById("publishedDate");
        const categoryEl           = document.getElementById("videoCategory");
        const progressBarEl        = document.getElementById("progressBar");
        const liveIndicatorEl      = document.getElementById("liveIndicator");
        const pauseIndicatorEl     = document.getElementById("pauseIndicator");
        const timeElapsedEl        = document.getElementById("timeElapsedContainer");
        const toggleDescBtn        = document.getElementById("toggleDescriptionButton");
        const descModal            = document.getElementById("descriptionModal");
    
        // State
        let currentVideoId   = null;
        let isBuffering      = false;
        let isBrowsing       = false;
        let browseStartTime  = null;
        let browseInterval   = null;
    
        const log = msg => console.log("[Haru.js] " + msg);
    
        // Utils
        function formatNumber(n) {
          if (typeof n === "string") n = n.replace(/,/g, "");
          const x = Number(n);
          return isNaN(x) ? "N/A" : x.toLocaleString();
        }
        function formatTime(sec) {
          const m = Math.floor(sec/60), s = sec%60;
          return m.toString().padStart(2,'0') + ':' + s.toString().padStart(2,'0');
        }
        function updateBrowseTime() {
          if (browseStartTime && timeElapsedEl) {
            const e = Math.floor((Date.now()-browseStartTime)/1000);
            timeElapsedEl.style.display = "block";
            timeElapsedEl.textContent = "⏱️ " + formatTime(e);
          }
        }
    
        // Clear UI for offline
        function clearDisplay() {
          if (isBuffering) return;
          nowPlayingBox?.classList.add("offline");
          offlineIndicator?.style.display = "block";
          offlineIndicator?.classList.add("visible");
          youtubeSection?.querySelectorAll("*:not(#offline-indicator)").forEach(el => el.style.display = "none");
          progressBarEl.style.width = "0%";
          timeElapsedEl.style.display = "none";
          videoThumbnailEl.parentElement.style.display = "none";
          [videoTitleEl, channelNameEl, viewCountEl, likeCountEl, publishedDateEl, categoryEl]
            .forEach(el => el && (el.textContent = ''));
          if (browseInterval) { clearInterval(browseInterval); browseInterval = null; }
          browseStartTime = null;
          toggleDescBtn.style.display = "none";
          log("Offline UI");
        }
    
        // Progress
        function updateProgress(data) {
          if (data.duration && data.currentTime != null) {
            const pct = data.currentTime/data.duration*100;
            progressBarEl.style.width = pct + "%";
          }
          liveIndicatorEl.classList.toggle("active", data.isLive);
          pauseIndicatorEl.classList.toggle("active", data.isPaused);
        }
    
        // Animate text & thumb
        function animateText(el, text, cls) {
          const old = el;
          const neu = old.cloneNode(true);
          neu.textContent = text;
          neu.classList.remove(cls);
          void neu.offsetWidth;
          neu.classList.add(cls);
          old.parentNode.replaceChild(neu, old);
        }
        function showVideo(data) {
          isBuffering = false;
          offlineIndicator.style.display = "none";
          youtubeSection.style.display = "block";
          nowPlayingBox.classList.remove("offline");
          updateProgress(data);
        }
    
        // Display new video
        function displayVideo(data) {
          isBuffering = true;
          currentVideoId = data.videoId;
          bufferOverlay.style.display = "block";
          youtubeSection.classList.add("fade-out");
          setTimeout(() => {
            animateText(videoTitleEl, data.title||"", "new-video-title");
            if (data.thumbnail) {
              animateText(videoThumbnailEl, '', 'new-video-thumbnail');
              videoThumbnailEl.src = data.thumbnail;
              videoThumbnailEl.parentElement.style.display = "block";
            }
            channelNameEl.textContent = data.channelTitle||"";
            viewCountEl.textContent   = formatNumber(data.viewCount);
            likeCountEl.textContent   = formatNumber(data.likeCount);
            publishedDateEl.textContent = data.publishedAt ? new Date(data.publishedAt).toLocaleDateString() : "";
            categoryEl.textContent    = data.category||"";
            descModal.querySelector('p').textContent = data.description||"";
            descModal.classList.remove('active');
            youtubeSection.classList.replace("fade-out","fade-in");
            bufferOverlay.style.display = "none";
            showVideo(data);
          }, 300);
        }
    
        // Display browsing
        function displayBrowse(data) {
          if (!isBrowsing) {
            browseStartTime = Date.now();
            browseInterval = setInterval(updateBrowseTime,1000);
            isBrowsing = true;
          }
          animateText(videoTitleEl, data.title||"", 'new-video-title');
          videoThumbnailEl.src = data.thumbnail||'';
          videoThumbnailEl.parentElement.style.display = data.thumbnail ? 'block':'none';
          updateBrowseTime();
          showVideo(data);
        }
    
        // Toggle description
        toggleDescBtn.addEventListener('click', e=>{
          e.stopPropagation();
          descModal.classList.toggle('active');
        });
    
        document.addEventListener('click', e=>{
          if (descModal.classList.contains('active') && !descModal.contains(e.target)) {
            descModal.classList.remove('active');
          }
        });
    
        // Socket
        const socket = io();
        socket.on('presenceUpdate', data=>{
          if (data.presenceType==='offline') return clearDisplay();
          if (data.presenceType==='video') {
            if (data.videoId===currentVideoId) return updateProgress(data);
            return displayVideo(data);
          }
          if (data.presenceType==='browsing') return displayBrowse(data);
          clearDisplay();
        });
    
      });
    })();
    </script>






    <script>
      document.addEventListener("DOMContentLoaded", function() {
        function updateClocks() {
          const now = new Date();
          const localTime = now.toLocaleTimeString([], {
            hour: "2-digit",
            minute: "2-digit",
            second: "2-digit",
          });
          const localTimeElement = document.getElementById("local-time");
          if (localTimeElement) localTimeElement.textContent = localTime;
          const currentDate = now.toLocaleDateString(undefined, {
            day: "2-digit",
            month: "long",
            year: "numeric",
          });
          const currentDateElement = document.getElementById("current-date");
          if (currentDateElement) currentDateElement.textContent = currentDate;
          const dayOfWeek = now.toLocaleDateString(undefined, {
            weekday: "long",
          });
          const dayOfWeekElement = document.getElementById("day-of-week");
          if (dayOfWeekElement) dayOfWeekElement.textContent = dayOfWeek;
        }
        setInterval(updateClocks, 1000);
        updateClocks();
      });
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        async function fetchWeather() {
          try {
            const response = await fetch("/api/weather?city=" + encodeURIComponent("Leeds"));
            const data = await response.json();
            if (data.error) throw new Error(data.error);
            displayWeather(data);
          } catch (error) {
            console.error("Error fetching weather data:", error);
            const weatherIconElement = document.getElementById("weather-icon");
            if (weatherIconElement) weatherIconElement.style.display = "none";
            const weatherDescription = document.getElementById("weather-description");
            if (weatherDescription) weatherDescription.innerText = "Unable to fetch weather data.";
          }
        }
        function displayWeather(data) {
          const description = data.weather[0].description,
                temperature = Math.round(data.main.temp),
                humidity = data.main.humidity,
                windSpeed = data.wind.speed,
                iconCode = data.weather[0].icon,
                iconUrl = "https://openweathermap.org/img/wn/" + iconCode + "@2x.png";
          document.getElementById("weather-description").innerText = "Condition: " + description;
          document.getElementById("temperature").innerText = "Temperature: " + temperature + "°C";
          document.getElementById("humidity").innerText = "Humidity: " + humidity + "%";
          document.getElementById("wind-speed").innerText = "Wind: " + windSpeed + " m/s";
          const weatherIconElement = document.getElementById("weather-icon");
          if (weatherIconElement) {
            weatherIconElement.src = iconUrl;
            weatherIconElement.style.display = "block";
          }
        }
        setInterval(fetchWeather, 3600000);
        fetchWeather();
      });
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        const canvas = document.getElementById("soundWaveCanvas");
        const ctx = canvas.getContext("2d");
        function resizeCanvas() {
          canvas.width = window.innerWidth;
          canvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener("resize", function() {
          resizeCanvas();
          columns = Math.floor(canvas.width / fontSize);
          drops = new Array(columns).fill(0);
          speeds = Array.from({ length: columns }, () => Math.random() * 0.05 + 0.05);
          phraseCounters = new Array(columns).fill(0);
          currentDigits = new Array(columns).fill("0");
        });
        const fontSize = 20;
        let columns = Math.floor(canvas.width / fontSize);
        let drops = new Array(columns).fill(0);
        let speeds = Array.from({ length: columns }, () => Math.random() * 0.05 + 0.05);
        let phraseCounters = new Array(columns).fill(0);
        let currentDigits = new Array(columns).fill("0");
        const binaryChars = "01";
        const colors = ["#00C6FF", "#ff4081"];
        const mikuPhrases = ["Hatsune Miku", "The First Sound of the Future", "39", "Digital Diva", "CV01", "01"];
        function hexToRGBA(hex, alpha) {
          const r = parseInt(hex.slice(1, 3), 16),
                g = parseInt(hex.slice(3, 5), 16),
                b = parseInt(hex.slice(5, 7), 16);
          return `rgba(${r}, ${g}, ${b}, ${alpha})`;
        }
        function drawMatrix() {
          ctx.fillStyle = "rgba(0, 0, 0, 0.05)";
          ctx.fillRect(0, 0, canvas.width, canvas.height);
          ctx.font = fontSize + "px monospace";
          ctx.shadowColor = "rgba(0, 0, 0, 0.8)";
          ctx.shadowBlur = 4;
          const trailLength = 6;
          for (let i = 0; i < drops.length; i++) {
            let dropIncrement = speeds[i];
            let text;
            if (phraseCounters[i] > 0) {
              dropIncrement = 0;
              phraseCounters[i]--;
            }
            if (phraseCounters[i] === 0 && Math.random() < 0.002) {
              text = mikuPhrases[Math.floor(Math.random() * mikuPhrases.length)];
              ctx.fillStyle = "#FF69B4";
              phraseCounters[i] = 180;
              dropIncrement = speeds[i] * 0.2;
            } else {
              if (Math.random() < 0.1) {
                currentDigits[i] = binaryChars.charAt(Math.floor(Math.random() * binaryChars.length));
              }
              text = currentDigits[i];
              ctx.fillStyle = colors[i % colors.length];
            }
            const x = i * fontSize;
            const y = Math.floor(drops[i]) * fontSize;
            ctx.fillText(text, x, y);
            for (let j = 1; j < trailLength; j++) {
              const ty = y - j * fontSize;
              if (ty < 0) break;
              const alpha = 1 - j / trailLength;
              ctx.fillStyle = hexToRGBA(colors[i % colors.length], alpha);
              ctx.fillText(binaryChars.charAt(Math.floor(Math.random() * binaryChars.length)), x, ty);
            }
            if (y > canvas.height && Math.random() > 0.995) {
              drops[i] = 0;
              speeds[i] = Math.random() * 0.05 + 0.05;
              phraseCounters[i] = 0;
              currentDigits[i] = "0";
            }
            drops[i] += dropIncrement;
          }
          requestAnimationFrame(drawMatrix);
        }
        drawMatrix();
      });
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        var toggleButton = document.getElementById("toggleDescriptionButton");
        var descriptionModal = document.getElementById("descriptionModal");
        if (localStorage.getItem("descriptionModalOpen") === "true") {
          descriptionModal.classList.add("active");
          toggleButton.innerHTML = '<i class="fas fa-info-circle"></i> Hide Description';
        } else {
          descriptionModal.classList.remove("active");
          toggleButton.innerHTML = '<i class="fas fa-info-circle"></i> Show Description';
        }
        toggleButton.addEventListener("click", function() {
          if (descriptionModal.classList.contains("active")) {
            descriptionModal.classList.remove("active");
            toggleButton.innerHTML = '<i class="fas fa-info-circle"></i> Show Description';
            localStorage.setItem("descriptionModalOpen", "false");
          } else {
            descriptionModal.classList.add("active");
            toggleButton.innerHTML = '<i class="fas fa-info-circle"></i> Hide Description';
            localStorage.setItem("descriptionModalOpen", "true");
          }
        });
      });
    </script>
  </body>
</html>




