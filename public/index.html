    <!DOCTYPE html>
    <html lang="en">
    
    <head>
        <!-- Meta Tags and Title -->
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>mm.dev | Home</title>
    
        <!-- Fonts and Stylesheets -->
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
        <link rel="stylesheet" href="/styles.css">
    
        <!-- Anime.js Library -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha512-6L+aYj4myl3XfQ+ScLyRkUQnZ4nC6ZoVv7LwOXjEBAih6gGm6B6HV6g9O8svtLeJeT3xHgFYBBUO0IgT3Z9Kug==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    </head>
    
    <body>
        <!-- Animated Background Container -->
        <div id="animeBackground" aria-hidden="true"></div>
    
        <!-- Central Tattoo Animation Container -->
        <div id="centralTattoo" aria-hidden="true">
            <!-- Custom Tattoo SVG Design -->
            <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                <!-- Example Tattoo Design -->
                <!-- Replace the paths below with your actual tattoo design -->
                <g id="tattooDesign">
                    <!-- Outer Circle -->
                    <circle cx="100" cy="100" r="90" fill="none" stroke="var(--tattoo-accent)" stroke-width="4" />
                    <!-- Inner Elements -->
                    <path d="M100,20 L120,80 L80,80 Z" fill="var(--tattoo-color)" />
                    <path d="M100,180 L120,120 L80,120 Z" fill="var(--tattoo-color)" />
                    <path d="M20,100 L80,120 L80,80 Z" fill="var(--tattoo-color)" />
                    <path d="M180,100 L120,120 L120,80 Z" fill="var(--tattoo-color)" />
                    <!-- Add more intricate paths to resemble Miku's tattoo -->
                </g>
            </svg>
        </div>
    
        <div class="page-container">
            <!-- Title Bar -->
            <header class="title-bar" id="titleBar">
                <div class="container">
                    <!-- Left Section: Empty for Alignment -->
                    <div class="left-section"></div>
    
                    <!-- Center Section: "mm.dev" Logo and Title -->
                    <div class="title-wrapper">
                        <a href="/" aria-label="Home" class="logo-link">
                            <!-- Site Title -->
                            <span class="site-title">mm.dev</span>
                            <!-- The Music Bar (Assuming it's part of your logo or additional decoration) -->
                            <div class="visualizer-wrapper">
                                <!-- Example Visualizer SVG -->
                                <svg class="visualizer" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                    <!-- Simple Bars for Visualization -->
                                    <rect x="10" y="30" width="10" height="40" fill="rgba(0, 198, 255, 0.7)">
                                        <animate attributeName="height" values="40;60;40" dur="2s" repeatCount="indefinite" />
                                    </rect>
                                    <rect x="30" y="25" width="10" height="50" fill="rgba(0, 198, 255, 0.7)">
                                        <animate attributeName="height" values="50;30;50" dur="2s" repeatCount="indefinite" />
                                    </rect>
                                    <rect x="50" y="20" width="10" height="60" fill="rgba(0, 198, 255, 0.7)">
                                        <animate attributeName="height" values="60;40;60" dur="2s" repeatCount="indefinite" />
                                    </rect>
                                    <rect x="70" y="35" width="10" height="35" fill="rgba(0, 198, 255, 0.7)">
                                        <animate attributeName="height" values="35;55;35" dur="2s" repeatCount="indefinite" />
                                    </rect>
                                </svg>
                            </div>
                        </a>
                    </div>
    
                    <!-- Right Section: Menu Button -->
                    <div class="right-section">
                        <button class="menu-button" id="openMenu" aria-label="Open Menu">
                            <i class="fas fa-bars"></i>
                        </button>
                    </div>
                </div>
            </header>
    
            <!-- Overlay Menu -->
            <nav class="overlay-menu" id="overlayMenu" aria-label="Main Navigation">
                <button class="close-overlay" id="closeMenu" aria-label="Close Menu">&times;</button>
                <div class="overlay-content">
                    <a href="#home"><i class="fas fa-home"></i>Home</a>
                    <a href="#about"><i class="fas fa-user"></i>About</a>
                    <a href="#services"><i class="fas fa-concierge-bell"></i>Services</a>
                    <a href="#contact"><i class="fas fa-envelope"></i>Contact</a>
                </div>
            </nav>
    
            <!-- Now Playing Section -->
            <section class="now-playing-container animate-now-playing">
                <div class="now-playing">
                    <div class="now-playing-sidebar">
                        <div class="sidebar-item">
                            <i class="fas fa-music"></i>
                            <span>Now Playing: Song Title</span>
                        </div>
                        <div class="sidebar-item">
                            <i class="fas fa-clock"></i>
                            <span>3:45 / 4:30</span>
                        </div>
                        <div class="sidebar-item video-category">
                            <i class="fas fa-video"></i>
                            <span>Category: Music Videos</span>
                        </div>
                    </div>
                    <!-- Clock Widget -->
                    <div class="clock-section">
                        <p class="greeting">Good Morning!</p>
                        <div class="clocks-container">
                            <!-- Digital Clock -->
                            <div class="digital-clock">
                                <span class="local-time">10:30 AM</span>
                                <span class="current-date">April 27, 2024</span>
                                <span class="day-of-week">Saturday</span>
                                <span class="time-zone">UTC+0</span>
                            </div>
                            <!-- Analog Clock -->
                            <div class="analog-clock-container">
                                <div class="analog-clock">
                                    <!-- SVG Analog Clock -->
                                    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                                        <circle cx="50" cy="50" r="48" fill="none" stroke="var(--primary-color)" stroke-width="2" />
                                        <!-- Hour Marks -->
                                        <g>
                                            <line x1="50" y1="10" x2="50" y2="20" stroke="var(--primary-color)" stroke-width="2" />
                                            <line x1="50" y1="80" x2="50" y2="90" stroke="var(--primary-color)" stroke-width="2" />
                                            <line x1="10" y1="50" x2="20" y2="50" stroke="var(--primary-color)" stroke-width="2" />
                                            <line x1="80" y1="50" x2="90" y2="50" stroke="var(--primary-color)" stroke-width="2" />
                                            <!-- Diagonal Hour Marks -->
                                            <line x1="15" y1="15" x2="22" y2="22" stroke="var(--primary-color)" stroke-width="2" />
                                            <line x1="78" y1="78" x2="85" y2="85" stroke="var(--primary-color)" stroke-width="2" />
                                            <line x1="15" y1="85" x2="22" y2="78" stroke="var(--primary-color)" stroke-width="2" />
                                            <line x1="78" y1="22" x2="85" y2="15" stroke="var(--primary-color)" stroke-width="2" />
                                        </g>
                                        <!-- Hour Hand -->
                                        <line id="hourHand" x1="50" y1="50" x2="50" y2="30" stroke="var(--primary-color)" stroke-width="4" stroke-linecap="round" />
                                        <!-- Minute Hand -->
                                        <line id="minuteHand" x1="50" y1="50" x2="70" y2="50" stroke="var(--secondary-color)" stroke-width="3" stroke-linecap="round" />
                                        <!-- Second Hand -->
                                        <line id="secondHand" x1="50" y1="50" x2="80" y2="50" stroke="#FF0000" stroke-width="2" stroke-linecap="round" />
                                    </svg>
                                </div>
                            </div>
                        </div>
                        <p class="last-visit-message">Welcome back! Your last visit was on April 25, 2024.</p>
                    </div>
                    <!-- Weather Section -->
                    <div class="weather-section">
                        <div class="weather-icon">
                            <!-- Custom Weather Icon SVG -->
                            <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
                                <!-- Example: Sunny Icon -->
                                <circle cx="32" cy="32" r="12" fill="yellow" />
                                <g stroke="yellow" stroke-width="4">
                                    <line x1="32" y1="5" x2="32" y2="15" />
                                    <line x1="32" y1="49" x2="32" y2="59" />
                                    <line x1="5" y1="32" x2="15" y2="32" />
                                    <line x1="49" y1="32" x2="59" y2="32" />
                                    <line x1="11" y1="11" x2="18" y2="18" />
                                    <line x1="46" y1="46" x2="53" y2="53" />
                                    <line x1="11" y1="53" x2="18" y2="46" />
                                    <line x1="46" y1="18" x2="53" y2="11" />
                                </g>
                            </svg>
                        </div>
                        <span class="weather-description">Sunny</span>
                        <span class="temperature">25°C</span>
                        <span class="humidity">Humidity: 60%</span>
                        <span class="wind-speed">Wind: 15 km/h</span>
                    </div>
                </div>
            </section>
    
            <!-- Video Section -->
            <section class="video-section">
                <div class="video-title-container">
                    <h2>Featured Videos</h2>
                    <p>Check out our latest music videos and performances.</p>
                </div>
                <div class="thumbnail-container">
                    <img src="video-thumbnail.jpg" alt="Video Thumbnail" class="video-thumbnail">
                    <div class="offline-indicator">Video is currently offline.</div>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar"></div>
                </div>
                <div class="time-elapsed">
                    <span>Elapsed Time:</span>
                    <span>1:23</span>
                </div>
                <button class="toggle-description">Toggle Description</button>
            </section>
    
            <!-- About Section -->
            <section class="about animate-about" id="about">
                <h2>About Us</h2>
                <p>
                    Welcome to mm.dev, your number one source for all things music and entertainment. We're dedicated to providing you the very best of content, with an emphasis on quality, creativity, and user experience.
                </p>
            </section>
    
            <!-- Footer Section -->
            <footer class="footer animate-footer">
                <div class="container">
                    <p>&copy; 2024 mm.dev. All rights reserved.</p>
                    <button class="manage-consent-button">Manage Cookies</button>
                </div>
            </footer>
        </div>
    
        <!-- Chat Box -->
        <div class="chat-box" id="chatBox">
            <div class="chat-header">
                <span>Chat</span>
                <button class="close-chat" aria-label="Close Chat">&times;</button>
            </div>
            <div class="chat-content">
                <div class="message user-message">
                    <div class="message-content">
                        <span class="icon"><i class="fas fa-user"></i></span>
                        <span>Hello! How can I help you today?</span>
                    </div>
                </div>
                <div class="message bot-message">
                    <div class="message-content">
                        <span class="icon"><i class="fas fa-robot"></i></span>
                        <span>Hi! I'm here to assist you with any queries.</span>
                    </div>
                </div>
                <!-- Add more messages as needed -->
            </div>
            <div class="chat-input-container">
                <input type="text" class="chat-input" placeholder="Type your message..." aria-label="Chat Input">
                <button class="send-message">Send</button>
            </div>
            <div class="chat-loading" id="chatLoading">
                <div class="loading-spinner"></div>
                <span>Loading...</span>
            </div>
        </div>
    
        <!-- Floating Chat Button -->
        <button class="open-chat-button" id="openChat" aria-label="Open Chat">
            <i class="fas fa-comments"></i>
        </button>
        <!-- End of Floating Chat Button -->

        <!-- Description Modal -->
        <div id="descriptionModal" class="modal" aria-hidden="true" role="dialog" aria-labelledby="descriptionModalTitle"
            aria-describedby="descriptionModalDescription">
            <div class="modal-content">
                <button class="close-button" id="closeDescriptionButton" aria-label="Close Description Modal"><i
                        class="fas fa-times"></i></button>
                <h2 id="descriptionModalTitle">Description</h2>
                <p id="descriptionModalDescription">Loading description...</p>
            </div>
        </div>
        <!-- End of Description Modal -->

        <!-- Consent Modal -->
        <div id="consentModal" class="modal" aria-hidden="true" role="dialog" aria-labelledby="consentModalTitle"
            aria-describedby="consentModalDescription">
            <div class="modal-content">
                <button class="close-button" id="closeConsentModal" aria-label="Close Consent Modal"><i
                        class="fas fa-times"></i></button>
                <h2 id="consentModalTitle"><i class="fas fa-cookie"></i> Cookie Consent</h2>
                <p id="consentModalDescription">
                    I use cookies stored in your browser to enhance your experience on my personal website. These cookies
                    are essential for the website's functionality. By clicking "Accept," you consent to their use. You can
                    also manage your cookie preferences in the "Manage Cookie Preferences" section.
                </p>
                <div class="consent-buttons">
                    <button id="acceptConsent" class="consent-button"><i class="fas fa-check"></i> Accept</button>
                    <button id="declineConsent" class="consent-button"><i class="fas fa-times"></i> Decline</button>
                </div>
            </div>
        </div>
        <!-- End of Consent Modal -->

        <!-- JavaScript Libraries -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.1/socket.io.min.js" crossorigin="anonymous"
            referrerpolicy="no-referrer"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
        <!-- Import Haru AI script -->
        <script src="haru.js"></script>
        <canvas id="techCanvas"></canvas>

        <!-- Tracking Script -->
        <script>
            document.addEventListener('DOMContentLoaded', function () {

                if (window.location.pathname !== '/admin') {

                    fetch('/track', {
                        method: 'POST',
                        credentials: 'include'
                    })
                        .then(response => response.json())
                        .then(data => {
                            console.log('Geolocation data sent successfully:', data);
                        })
                        .catch(error => {
                            console.error('Error sending geolocation data:', error);
                        });
                }
            });
        </script>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                // Function to add animation classes with staggered delays
                function animateElements() {
                    // Title Bar Animation
                    const titleBar = document.getElementById('titleBar');
                    if (titleBar) {
                        setTimeout(() => {
                            titleBar.classList.add('animate-title-bar');
                            console.log('Added animate-title-bar to titleBar');
                        }, 100); // Delay of 100ms
                    } else {
                        console.error('Title Bar element not found!');
                    }
                    // Now Playing Section Animation
                    const nowPlaying = document.querySelector('.now-playing-container');
                    if (nowPlaying) {
                        setTimeout(() => {
                            nowPlaying.classList.add('animate-now-playing');
                            console.log('Added animate-now-playing to nowPlaying');
                        }, 400); // Delay of 400ms
                    } else {
                        console.error('Now Playing container not found!');
                    }

                    // About Me Section Animation
                    const aboutMe = document.querySelector('.about');
                    if (aboutMe) {
                        setTimeout(() => {
                            aboutMe.classList.add('animate-about');
                            console.log('Added animate-about to aboutMe');
                        }, 700); // Delay of 700ms
                    } else {
                        console.error('About Me section not found!');
                    }

                    // Footer Animation
                    const footer = document.querySelector('.footer');
                    if (footer) {
                        setTimeout(() => {
                            footer.classList.add('animate-footer');
                            console.log('Added animate-footer to footer');
                        }, 1000); // Delay of 1000ms
                    } else {
                        console.error('Footer element not found!');
                    }
                }

                animateElements();

                // Title Bar Scroll Effect
                const titleBarElement = document.getElementById('titleBar');
                if (titleBarElement) {
                    window.addEventListener('scroll', () => {
                        if (window.scrollY > 50) {
                            titleBarElement.classList.add('scrolled');
                            console.log('Added scrolled class to titleBar');
                        } else {
                            titleBarElement.classList.remove('scrolled');
                            console.log('Removed scrolled class from titleBar');
                        }
                    });
                } else {
                    console.error('Title Bar element not found for scroll effect!');
                }

                // Overlay Menu Functionality
                const menuButton = document.getElementById('menuButton');
                const overlayMenu = document.getElementById('overlayMenu');
                const closeOverlay = document.getElementById('closeOverlay');

                if (menuButton && overlayMenu) {
                    menuButton.addEventListener('click', (e) => {
                        e.stopPropagation(); // Prevent event bubbling
                        overlayMenu.classList.add('active');
                        document.body.classList.add('overlay-active');
                        console.log('Overlay menu activated');
                    });
                } else {
                    console.error('Menu Button or Overlay Menu element not found!');
                }

                if (closeOverlay && overlayMenu) {
                    closeOverlay.addEventListener('click', (e) => {
                        e.stopPropagation(); // Prevent event bubbling
                        overlayMenu.classList.remove('active');
                        document.body.classList.remove('overlay-active');
                        console.log('Overlay menu deactivated');
                    });
                } else {
                    console.error('Close Overlay button or Overlay Menu element not found!');
                }

                // Close menu when clicking outside of it
                window.addEventListener('click', (event) => {
                    if (event.target === overlayMenu) {
                        overlayMenu.classList.remove('active');
                        document.body.classList.remove('overlay-active');
                        console.log('Overlay menu closed by clicking outside');
                    }
                });

                // Personality Options Functionality
                const personalityButtons = document.querySelectorAll('.personality-button');
                const siteTitle = document.querySelector('.site-title');

                if (personalityButtons.length > 0 && siteTitle) {
                    personalityButtons.forEach(button => {
                        button.addEventListener('click', () => {
                            const personality = button.textContent.trim();
                            changeTitleStyle(personality);
                            setActivePersonalityButton(button);
                        });
                    });
                } else {
                    if (personalityButtons.length === 0) {
                        console.error('No personality buttons found!');
                    }
                    if (!siteTitle) {
                        console.error('Site Title element not found!');
                    }
                }

                function changeTitleStyle(personality) {
                    switch (personality) {
                        case 'Melody':
                            siteTitle.style.color = '#FF4081';
                            siteTitle.style.textShadow = '2px 2px 5px rgba(255, 64, 129, 0.5)';
                            console.log('Changed title style to Melody');
                            break;
                        case 'Harmony':
                            siteTitle.style.color = '#00c6ff';
                            siteTitle.style.textShadow = '2px 2px 5px rgba(0, 198, 255, 0.5)';
                            console.log('Changed title style to Harmony');
                            break;
                        case 'Rhythm':
                            siteTitle.style.color = '#FFD700';
                            siteTitle.style.textShadow = '2px 2px 5px rgba(255, 215, 0, 0.5)';
                            console.log('Changed title style to Rhythm');
                            break;
                        default:
                            siteTitle.style.color = '#00c6ff';
                            siteTitle.style.textShadow = '2px 2px 5px rgba(0, 198, 255, 0.5)';
                            console.log('Reverted title style to default');
                    }
                }

                function setActivePersonalityButton(activeButton) {
                    personalityButtons.forEach(btn => {
                        btn.classList.remove('active');
                    });
                    activeButton.classList.add('active');
                    console.log(`Active personality button set to ${activeButton.textContent.trim()}`);
                }
            });
        </script>

        <script>
            // [Cookie Consent Script]
            (function () {
                'use strict';

                const CONFIG = {
                    consentCookieName: 'cookieConsent',
                    consentCookieExpiryDays: 365,
                    consentCookiePath: '/',
                    consentModalId: 'consentModal',
                    acceptButtonId: 'acceptConsent',
                    declineButtonId: 'declineConsent',
                    manageButtonIds: ['manageConsentModal', 'manageConsentFooter'],
                    closeButtonId: 'closeConsentModal',
                    cookieCategories: {
                        necessary: {
                            enabled: true,
                            description: 'Necessary cookies enable core functionalities and security features of the website.'
                        }
                    },
                    focusableSelectors: 'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])',
                };

                const consentModal = document.getElementById(CONFIG.consentModalId);
                const acceptButton = document.getElementById(CONFIG.acceptButtonId);
                const declineButton = document.getElementById(CONFIG.declineButtonId);
                const closeButton = document.getElementById(CONFIG.closeButtonId);
                const manageConsentButtons = CONFIG.manageButtonIds.map(id => document.getElementById(id));

                function setCookie(name, value, days, path = '/') {
                    let expires = "";
                    if (days) {
                        const date = new Date();
                        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                        expires = "; expires=" + date.toUTCString();
                    }
                    const secure = location.protocol === 'https:' ? "; Secure" : "";
                    const sameSite = "; SameSite=Lax";
                    document.cookie = name + "=" + (value || "") + expires + "; path=" + path + secure + sameSite;
                }

                function getCookie(name) {
                    const nameEQ = name + "=";
                    const ca = document.cookie.split(';');
                    for (let i = 0; i < ca.length; i++) {
                        let c = ca[i];
                        while (c.charAt(0) === ' ') c = c.substring(1, c.length);
                        if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
                    }
                    return null;
                }

                function eraseCookie(name, path = '/') {
                    document.cookie = name + '=; Max-Age=-99999999; path=' + path + ';';
                }

                function trapFocus(modal) {
                    const focusableElements = modal.querySelectorAll(CONFIG.focusableSelectors);
                    if (focusableElements.length === 0) return;
                    const firstFocusableElement = focusableElements[0];
                    const lastFocusableElement = focusableElements[focusableElements.length - 1];

                    function handleFocus(event) {
                        if (event.key === 'Tab') {
                            if (event.shiftKey) {
                                if (document.activeElement === firstFocusableElement) {
                                    event.preventDefault();
                                    lastFocusableElement.focus();
                                }
                            } else {
                                if (document.activeElement === lastFocusableElement) {
                                    event.preventDefault();
                                    firstFocusableElement.focus();
                                }
                            }
                        }
                        if (event.key === 'Escape') {
                            event.preventDefault();
                        }
                    }

                    modal.addEventListener('keydown', handleFocus);
                }

                function showModal() {
                    consentModal.classList.add('active');
                    document.body.classList.add('modal-active');
                    consentModal.setAttribute('aria-hidden', 'false');

                    const focusableElements = consentModal.querySelectorAll(CONFIG.focusableSelectors);
                    if (focusableElements.length) {
                        focusableElements[0].focus();
                    }

                    trapFocus(consentModal);
                }

                function hideModal() {
                    consentModal.classList.remove('active');
                    document.body.classList.remove('modal-active');
                    consentModal.setAttribute('aria-hidden', 'true');
                }

                function initConsentModal() {
                    const existingConsent = getCookie(CONFIG.consentCookieName);

                    if (!existingConsent) {
                        showModal();
                    } else {
                        applyConsent(existingConsent);
                    }

                    acceptButton.addEventListener('click', function () {
                        setCookie(CONFIG.consentCookieName, JSON.stringify({
                            necessary: true
                        }), CONFIG.consentCookieExpiryDays, CONFIG.consentCookiePath);
                        hideModal();
                        initializeCookies();
                    });

                    declineButton.addEventListener('click', function () {
                        setCookie(CONFIG.consentCookieName, JSON.stringify({
                            necessary: false
                        }), CONFIG.consentCookieExpiryDays, CONFIG.consentCookiePath);
                        hideModal();
                        disableCookies();
                    });

                    manageConsentButtons.forEach(button => {
                        if (button) {
                            button.addEventListener('click', function (event) {
                                event.preventDefault();
                                showModal();
                            });
                        }
                    });

                    closeButton.addEventListener('click', function () {
                        alert('Please make a choice regarding cookie usage.');
                    });

                    window.addEventListener('click', function (event) {
                        if (event.target === consentModal) {
                            alert('Please make a choice regarding cookie usage.');
                        }
                    });
                }

                function applyConsent(consentValue) {
                    try {
                        const consent = JSON.parse(consentValue);
                        if (consent.necessary) {
                            initializeCookies(consent);
                        } else {
                            disableCookies();
                        }
                    } catch (error) {
                        console.error('Error parsing consent cookie:', error);
                        showModal();
                    }
                }

                function initializeCookies(consent) {
                    console.log('Necessary cookies enabled.');
                }

                function disableCookies() {
                    console.log('Necessary cookies disabled.');
                }

                function areCookiesEnabled() {
                    const testCookie = 'test_cookie_consent';
                    setCookie(testCookie, 'test', 1);
                    const result = getCookie(testCookie) === 'test';
                    eraseCookie(testCookie);
                    return result;
                }

                function init() {
                    if (areCookiesEnabled()) {
                        initConsentModal();
                    } else {
                        console.warn('Cookies are disabled in this browser. Consent modal will not be displayed.');
                    }
                }

                document.addEventListener('DOMContentLoaded', init);
            })();
        </script>

        <script>
            // Now Playing Elements and Socket.IO Integration
            const socket = io("https://mikumiku.dev");
            let lastHeartbeatReceived = Date.now();
            let isSessionExpired = false;
            let browsingStartTime = null;
            let browsingInterval = null;

            const nowPlayingBox = document.getElementById("nowPlayingBox");
            const videoTitleElement = document.getElementById("videoTitle");
            const videoThumbnailImage = document.getElementById("videoThumbnailImage");
            const videoThumbnailElement = document.getElementById("videoThumbnail");
            const offlineIndicatorElement = document.getElementById("offline-indicator");
            const progressBarElement = document.getElementById("progressBar");
            const channelNameElement = document.getElementById("channelName");
            const viewCountElement = document.getElementById("viewCount");
            const likeCountElement = document.getElementById("likeCount");
            const publishedDateElement = document.getElementById("publishedDate");
            const videoCategoryElement = document.getElementById("videoCategory");
            const videoDescriptionElement = document.getElementById("descriptionModalDescription");
            const timeElapsedElement = document.getElementById("timeElapsed");
            const liveIconElement = document.getElementById("liveIcon"); // LIVE Indicator

            function formatNumber(number) {
                if (typeof number === 'string') {
                    number = number.replace(/,/g, '');
                }
                const num = Number(number);
                return isNaN(num) ? "N/A" : num.toLocaleString();
            }

            function clearDisplay() {
                nowPlayingBox.classList.add("offline");
                offlineIndicatorElement.style.display = "block";
                videoTitleElement.textContent = "I’m not on YouTube at the moment, soz :(";
                videoThumbnailImage.src = "";
                videoThumbnailImage.style.display = "none";
                videoThumbnailElement.src = "";
                videoThumbnailElement.style.display = "none";
                channelNameElement.textContent = "";
                viewCountElement.textContent = "";
                likeCountElement.textContent = "";
                publishedDateElement.textContent = "";
                videoCategoryElement.textContent = "";
                progressBarElement.style.width = "0%";
                videoDescriptionElement.textContent = "";
                timeElapsedElement.style.display = "none";
                liveIconElement.style.display = "none"; // Hide LIVE Icon
            }

            function clearVideoPresence() {
                videoTitleElement.textContent = "";
                videoThumbnailImage.src = "";
                videoThumbnailImage.style.display = "none";
                videoThumbnailElement.src = "";
                videoThumbnailElement.style.display = "none";
                channelNameElement.textContent = "";
                viewCountElement.textContent = "";
                likeCountElement.textContent = "";
                publishedDateElement.textContent = "";
                videoCategoryElement.textContent = "";
                progressBarElement.style.width = "0%";
                videoDescriptionElement.textContent = "";
                liveIconElement.style.display = "none"; // Hide LIVE Icon
            }

            function reinitializeSession() {
                console.warn("[Client] Reinitializing session due to mismatch or timeout.");
                clearDisplay();
                isSessionExpired = true;
            }

            function formatTimeElapsed(seconds) {
                const hours = Math.floor(seconds / 3600);
                const minutes = Math.floor((seconds % 3600) / 60);
                const remainingSeconds = seconds % 60;

                if (hours > 0) {
                    return `${hours}h ${minutes}m ${remainingSeconds}s`;
                } else if (minutes > 0) {
                    return `${minutes}m ${remainingSeconds}s`;
                } else {
                    return `${remainingSeconds}s`;
                }
            }

            function displayVideoPresence(data) {
                lastHeartbeatReceived = Date.now();
                nowPlayingBox.classList.remove("offline");
                offlineIndicatorElement.style.display = "none";
            
                videoTitleElement.textContent = data.title || "Unknown Title";
            
                if (data.thumbnail) {
                    videoThumbnailImage.src = data.thumbnail;
                    videoThumbnailImage.style.display = "block";
                    videoThumbnailElement.style.display = "none";
                } else {
                    videoThumbnailImage.src = "";
                    videoThumbnailElement.style.display = "none";
                }
            
                channelNameElement.textContent = data.channelTitle || "Unknown Channel";
                viewCountElement.textContent = `${formatNumber(data.viewCount)}` || "N/A";
                likeCountElement.textContent = `${formatNumber(data.likeCount)}` || "N/A";
            
                if (data.publishedAt) {
                    const publishedDate = new Date(data.publishedAt);
                    publishedDateElement.textContent = ` ${publishedDate.toLocaleDateString()}` || "Published on: N/A";
                } else {
                    publishedDateElement.textContent = "Published on: N/A";
                }
            
                videoCategoryElement.textContent = `${data.category}` || "N/A";
                videoDescriptionElement.textContent = data.description || "No description available.";
                handleRealTimeProgress(data);
                timeElapsedElement.style.display = "none";
            
                if (data.videoSrc) {
                    videoThumbnailElement.src = data.videoSrc;
                    videoThumbnailElement.style.display = "block";
                    videoThumbnailImage.style.display = "none";
                } else {
                    videoThumbnailElement.style.display = "none";
                    videoThumbnailImage.style.display = "block";
                }
            
                // Handle Live Status
                if (data.isLive) {
                    liveIconElement.classList.add('active'); // Add active class to trigger animation
                    liveIconElement.style.display = "flex"; // Use 'flex' to utilize CSS flex properties
                } else {
                    liveIconElement.classList.remove('active'); // Remove active class
                    liveIconElement.style.display = "none"; // Hide the live icon when not live
                }
            }


            function handleRealTimeProgress(data) {
                if (data.duration && data.currentTime) {
                    const progressPercentage = (data.currentTime / data.duration) * 100;
                    progressBarElement.style.width = `${progressPercentage}%`;
                } else {
                    progressBarElement.style.width = "0%";
                }
            }

            function displayBrowsingPresence(data) {
                lastHeartbeatReceived = Date.now();
                nowPlayingBox.classList.remove("offline");
                offlineIndicatorElement.style.display = "none";

                clearVideoPresence();

                videoTitleElement.textContent = data.title || "Browsing YouTube";
                videoThumbnailImage.src = data.thumbnail || "";
                videoThumbnailImage.style.display = "block";
                videoThumbnailElement.style.display = "none";
                channelNameElement.textContent = "Browsing...";
                videoDescriptionElement.textContent = data.description || "Browsing videos on YouTube";
                progressBarElement.style.width = "0%";

                if (data.timeElapsed !== undefined) {
                    timeElapsedElement.textContent = `Time Elapsed: ${formatTimeElapsed(data.timeElapsed)}`;
                    timeElapsedElement.style.display = "block";
                }
            }

            function updateBrowsingPresence() {
                if (browsingStartTime !== null) {
                    const timeElapsed = Math.floor((Date.now() - browsingStartTime) / 1000);
                    timeElapsedElement.textContent = `Time Elapsed: ${formatTimeElapsed(timeElapsed)}`;
                    timeElapsedElement.style.display = "block";

                    const browsingData = {
                        title: 'YouTube',
                        description: 'Browsing videos',
                        thumbnail: '',
                        timeElapsed: timeElapsed,
                        presenceType: 'browsing'
                    };
                    socket.emit('updateBrowsingPresence', browsingData);
                }
            }

            function startBrowsingPresence() {
                if (browsingStartTime === null) {
                    browsingStartTime = Date.now();
                }
                if (!browsingInterval) {
                    browsingInterval = setInterval(updateBrowsingPresence, 5000);
                }
            }

            function stopBrowsingPresence() {
                if (browsingInterval) {
                    clearInterval(browsingInterval);
                    browsingInterval = null;
                }
                browsingStartTime = null;
            }

            socket.on("connect", () => {
                console.log("[Socket.IO] Connected to server.");
                isSessionExpired = false;
                socket.emit('requestLatestData');
            });

            socket.on("presenceUpdate", (data) => {
                if (isSessionExpired) {
                    console.warn("[Client] Ignoring presenceUpdate due to expired session.");
                    return;
                }

                console.log("[Socket.IO] Received presenceUpdate:", data);

                if (data.presenceType === 'video') {
                    stopBrowsingPresence();
                    displayVideoPresence(data);
                } else if (data.presenceType === 'browsing') {
                    displayBrowsingPresence(data);
                    startBrowsingPresence();
                } else {
                    clearDisplay();
                }
            });

            socket.on("reinitializeSession", (data) => {
                console.warn(`[Socket.IO] Received reinitializeSession: ${JSON.stringify(data)}`);
                reinitializeSession();
            });

            socket.on("sessionExpired", (data) => {
                console.warn(`[Socket.IO] Session expired for video ID: ${data.videoId}`);
                reinitializeSession();
            });

            socket.on("disconnect", () => {
                console.warn("[Socket.IO] Disconnected from server.");
                stopBrowsingPresence();
                clearDisplay();
            });

            setInterval(() => {
                if (Date.now() - lastHeartbeatReceived > 60000) {
                    console.warn("[Heartbeat] No heartbeat received in the last 60 seconds. Marking as offline.");
                    clearDisplay();
                }
            }, 5000);

            // Modal Toggle Logic
            const descriptionModal = document.getElementById("descriptionModal");
            const closeDescriptionButton = document.getElementById("closeDescriptionButton");
            const toggleDescriptionButton = document.getElementById("toggleDescriptionButton");

            toggleDescriptionButton.addEventListener("click", function () {
                if (descriptionModal.style.display === "block") {
                    descriptionModal.style.display = "none";
                    toggleDescriptionButton.textContent = "Show Description";
                } else {
                    descriptionModal.style.display = "flex";
                    descriptionModal.classList.add('active');
                    toggleDescriptionButton.textContent = "Hide Description";
                }
            });

            closeDescriptionButton.addEventListener("click", function () {
                descriptionModal.style.display = "none";
                descriptionModal.classList.remove('active');
                toggleDescriptionButton.textContent = "Show Description";
            });

            window.addEventListener("click", function (event) {
                if (event.target === descriptionModal) {
                    descriptionModal.style.display = "none";
                    toggleDescriptionButton.textContent = "Show Description";
                }
            });


            // Clock Update Script
            function updateClocks() {
                const now = new Date();
                const localTime = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });
                const localTimeElement = document.getElementById('local-time');
                if (localTimeElement) localTimeElement.textContent = localTime;
                const currentDate = now.toLocaleDateString(undefined, { day: '2-digit', month: 'short', year: 'numeric' });
                const currentDateElement = document.getElementById('current-date');
                if (currentDateElement) currentDateElement.textContent = currentDate;
            }

            setInterval(updateClocks, 1000);
            updateClocks();

            // Weather Update Script
            const CITY_NAME = 'Leeds';
            async function fetchWeather() {
                try {
                    const response = await fetch(`/api/weather?city=${encodeURIComponent(CITY_NAME)}`);
                    const data = await response.json();

                    if (data.error) {
                        throw new Error(data.error);
                    }

                    displayWeather(data);
                } catch (error) {
                    console.error('Error fetching weather data:', error);
                    const weatherIconElement = document.getElementById('weather-icon');
                    if (weatherIconElement) weatherIconElement.style.display = 'none';
                    document.getElementById('weather-description').innerText = 'Unable to fetch weather data.';
                }
            }

            function displayWeather(data) {
                const description = data.weather[0].description;
                const temperature = Math.round(data.main.temp);
                const humidity = data.main.humidity;
                const windSpeed = data.wind.speed;
                const iconCode = data.weather[0].icon;
                const iconUrl = `https://openweathermap.org/img/wn/${iconCode}@2x.png`;

                document.getElementById('weather-description').innerText = `Condition: ${description}`;
                document.getElementById('temperature').innerText = `Temperature: ${temperature}°C`;
                document.getElementById('humidity').innerText = `Humidity: ${humidity}%`;
                document.getElementById('wind-speed').innerText = `Wind: ${windSpeed} m/s`;

                const weatherIconElement = document.getElementById('weather-icon');
                if (weatherIconElement) {
                    weatherIconElement.src = iconUrl;
                    weatherIconElement.style.display = 'block';
                }
            }

            setInterval(fetchWeather, 3600000); // Update every hour
            fetchWeather();
        </script>

        <!-- Animated Background Script -->
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const animeBackground = document.getElementById('animeBackground');
                const centralTattoo = document.getElementById('centralTattoo');
    
                // Array of SVGs for variety
                const svgNotes = [
                    `<svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
                        <path d="M48 3L24 11V43H16V11L-8 3V61H48V3Z"/>
                    </svg>`,
                    `<svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="32" cy="32" r="30" stroke="rgba(0, 198, 255, 0.7)" stroke-width="4" fill="none"/>
                    </svg>`,
                    // Add more SVGs as desired
                ];
    
                const colors = ['rgba(0, 198, 255, 0.7)', 'rgba(0, 150, 255, 0.7)', 'rgba(0, 180, 255, 0.7)'];
    
                // Function to create a musical note element
                function createMusicalNote() {
                    const note = document.createElement('div');
                    note.classList.add('background-note');
    
                    const randomSVG = svgNotes[Math.floor(Math.random() * svgNotes.length)];
                    const randomColor = colors[Math.floor(Math.random() * colors.length)];
                    const coloredSVG = randomSVG.replace('rgba(0, 198, 255, 0.7)', randomColor);
    
                    note.innerHTML = coloredSVG;
    
                    // Randomize initial position and size
                    note.style.left = `${Math.random() * 100}%`;
                    note.style.width = `${20 + Math.random() * 30}px`;
                    note.style.height = `${20 + Math.random() * 30}px`;
    
                    animeBackground.appendChild(note);
    
                    // Animate the note
                    anime({
                        targets: note,
                        translateY: [
                            { value: '-110vh', duration: 10000 + Math.random() * 5000, easing: 'linear' }
                        ],
                        translateX: [
                            { value: () => Math.random() * 100 - 50, duration: 10000 + Math.random() * 5000, easing: 'easeInOutSine' }
                        ],
                        rotate: {
                            value: () => Math.random() * 360,
                            duration: 10000 + Math.random() * 5000,
                            easing: 'linear'
                        },
                        opacity: [
                            { value: 1, duration: 0 },
                            { value: 0, duration: 500, easing: 'linear' }
                        ],
                        complete: function (anim) {
                            note.remove(); // Remove the note after animation
                        }
                    });
                }
    
                // Function to create multiple musical notes at intervals
                function generateMusicalNotes() {
                    setInterval(createMusicalNote, 800); // Adjust the interval as needed
                }
    
                // Initialize musical notes generation
                generateMusicalNotes();
    
                // Central Tattoo Advanced Animations
                // The tattoo animations are handled via CSS keyframes: rotateTattoo and pulseTattoo
                // Additional JavaScript animations can be added here if needed
    
                // Example: Interactive Glow on Hover
                centralTattoo.addEventListener('mouseenter', () => {
                    anime({
                        targets: '#centralTattoo svg',
                        scale: 1.05,
                        duration: 500,
                        easing: 'easeInOutQuad'
                    });
                });
    
                centralTattoo.addEventListener('mouseleave', () => {
                    anime({
                        targets: '#centralTattoo svg',
                        scale: 1,
                        duration: 500,
                        easing: 'easeInOutQuad'
                    });
                });
        </script>
    </div>
</body>

</html>
