<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Miku.dev | Home</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700;900&display=swap" rel="stylesheet"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer"/>

    <style>
      :root{--primary-color:#00c6ff;--secondary-color:#ff4081;--background-color:transparent;--canvas-background-color:#2e2e2e;--modal-background:rgba(0,0,0,.85);--text-color:#fff;--muted-text:rgba(255,255,255,.75);--border-color:rgba(255,255,255,.2);--button-hover-bg:rgba(255,64,129,.8);--shadow-color:rgba(0,0,0,.5);--accent-color:#ff4081;--glass-bg:rgba(255,255,255,.06);--glass-stroke:rgba(255,255,255,.18);--focus-ring:0 0 0 3px rgba(0,198,255,.35),0 0 0 6px rgba(255,64,129,.25);--font-family:'Roboto',sans-serif;--title-font-size:3rem;--content-font-size:1rem;--small-font-size:.875rem;--padding-base:1rem;--padding-large:2rem;--margin-base:1rem;--margin-large:2rem;--transition-duration:.25s;--animation-duration:.6s;--border-radius:12px;--wave-opacity:.6;--wave-glow:25px}
      *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
      html,body{height:100%;width:100%;font-family:var(--font-family);color:var(--text-color);background-color:var(--background-color);overflow-x:hidden}
      body{display:flex;flex-direction:column}
      .page-container{display:flex;flex-direction:column;flex:1;min-height:100vh;position:relative;z-index:1;opacity:0;animation:fadeInPage var(--animation-duration) ease-out forwards;padding-bottom:3.5rem}
      #soundWaveCanvas{position:fixed;inset:0;z-index:-4;background-color:var(--canvas-background-color);pointer-events:none;overflow:hidden;mix-blend-mode:screen}
      .title-bar{background:rgba(0,0,0,.65);padding:var(--padding-base);position:sticky;top:0;width:100%;z-index:10;display:flex;justify-content:center;align-items:center;box-shadow:0 2px 4px var(--shadow-color);transition:background-color var(--transition-duration) ease,box-shadow var(--transition-duration) ease,backdrop-filter var(--transition-duration) ease;opacity:0;animation:fadeInUp var(--animation-duration) ease-out .2s forwards;backdrop-filter:saturate(120%) blur(6px);border-bottom:1px solid var(--glass-stroke)}
      .title-bar.scrolled{background-color:rgba(0,0,0,.9);box-shadow:0 4px 18px rgba(0,0,0,.6);backdrop-filter:saturate(140%) blur(8px)}
      .container{width:100%;max-width:1200px;display:flex;align-items:center;justify-content:space-between;margin:0 auto;padding-inline:.25rem}
      .title-wrapper{display:flex;align-items:center;justify-content:center;position:relative}
      .logo-link{display:flex;align-items:center;text-decoration:none;gap:1rem}
      .site-title{font-size:var(--title-font-size);font-weight:900;letter-spacing:.5px;color:var(--primary-color);position:relative;z-index:2;transition:color var(--transition-duration) ease,text-shadow var(--transition-duration) ease,transform var(--transition-duration) ease;text-shadow:0 0 12px rgba(0,198,255,.4)}
      .site-title:hover{color:var(--secondary-color);text-shadow:0 0 14px rgba(255,64,129,.6);transform:translateY(-1px)}
      .visualizer-wrapper{position:absolute;bottom:-10px;left:50%;transform:translateX(-50%);width:200px;height:80px;z-index:1}
      .visualizer{width:100%;height:100%;filter:drop-shadow(0 0 10px var(--primary-color));animation:visualizerPulse 3s infinite}
      @keyframes visualizerPulse{0%,100%{filter:drop-shadow(0 0 10px var(--primary-color))}50%{filter:drop-shadow(0 0 20px var(--secondary-color))}}
      .menu-button{background:var(--glass-bg);border:1px solid var(--glass-stroke);border-radius:50%;width:44px;height:44px;cursor:pointer;display:grid;place-items:center;transition:background-color var(--transition-duration) ease,transform var(--transition-duration) ease,box-shadow var(--transition-duration) ease;box-shadow:0 6px 18px rgba(0,0,0,.35)}
      .menu-button i{color:var(--text-color);font-size:1.15rem}
      .menu-button:hover{background:linear-gradient(135deg,rgba(0,198,255,.35),rgba(255,64,129,.35));transform:scale(1.08);box-shadow:0 10px 28px rgba(0,0,0,.45)}
      .menu-button:focus-visible{outline:none;box-shadow:var(--focus-ring)}
      .overlay-menu{position:fixed;inset:0;background:rgba(0,0,0,.95);backdrop-filter:blur(6px);display:none;flex-direction:column;align-items:center;justify-content:center;z-index:2000;transition:opacity .25s ease,visibility .25s ease;opacity:0;visibility:hidden}
      .overlay-menu.active{display:flex;opacity:1;visibility:visible}
      .close-overlay{position:absolute;top:var(--padding-base);right:var(--padding-base);background:none;border:none;color:var(--text-color);font-size:2rem;cursor:pointer;transition:color .25s ease,transform .25s ease}
      .close-overlay:hover{color:var(--secondary-color);transform:rotate(90deg) scale(1.05)}
      .close-overlay:focus-visible{outline:none;box-shadow:var(--focus-ring);border-radius:8px}
      .overlay-content{display:flex;flex-direction:column;align-items:center;gap:1.25rem}
      .overlay-content a{color:var(--text-color);font-size:1.4rem;text-decoration:none;display:inline-flex;align-items:center;gap:.6rem;transition:color .25s ease,transform .25s ease,text-shadow .25s ease}
      .overlay-content a:hover{color:var(--secondary-color);transform:translateY(-1px);text-shadow:0 0 12px rgba(255,64,129,.45)}
      .personality-options{display:flex;gap:.8rem;margin-top:.5rem;flex-wrap:wrap;justify-content:center}
      .personality-button{background:var(--glass-bg);border:1px solid var(--glass-stroke);color:var(--text-color);padding:.55rem 1rem;border-radius:999px;cursor:pointer;display:inline-flex;align-items:center;gap:.5rem;transition:background-color .25s ease,transform .25s ease,box-shadow .25s ease,border-color .25s ease;box-shadow:0 8px 20px rgba(0,0,0,.35)}
      .personality-button:hover{background:linear-gradient(135deg,rgba(0,198,255,.25),rgba(255,64,129,.25));transform:translateY(-1px);box-shadow:0 10px 26px rgba(0,0,0,.45);border-color:transparent}
      .personality-button.active{background:linear-gradient(135deg,rgba(0,198,255,.35),rgba(255,64,129,.35));border-color:transparent}
      .personality-button:focus-visible{outline:none;box-shadow:var(--focus-ring)}
      .now-playing-container{flex:1;display:flex;justify-content:center;align-items:center;padding:var(--padding-large);background:radial-gradient(1200px 800px at 50% -10%,rgba(0,198,255,.12),transparent 60%),rgba(0,0,0,.5);opacity:0;animation:fadeInUp var(--animation-duration) ease-out .4s forwards}
      .now-playing-card{width:100%;max-width:1100px;background:rgba(0,0,0,.72);border:1px solid var(--glass-stroke);border-radius:var(--border-radius);padding:calc(var(--padding-large)*.9);box-shadow:0 12px 40px rgba(0,0,0,.6),0 0 0 1px rgba(255,255,255,.03) inset;backdrop-filter:blur(8px) saturate(120%);transition:opacity .5s ease,transform .3s ease,box-shadow .3s ease;overflow:hidden}
      .now-playing-card:hover{transform:translateY(-2px);box-shadow:0 16px 50px rgba(0,0,0,.7)}
      .now-playing-grid{display:grid;grid-template-columns:1.8fr 1.2fr 2.3fr 1fr;grid-template-areas:"videoInfo timeInfo youtubeSection weatherSection";gap:1.8rem;min-width:0}
      .now-playing-card.fade-out{opacity:0}
      .now-playing-card.fade-in{opacity:1}
      .video-info{grid-area:videoInfo;border-right:1px dashed var(--glass-stroke);border-bottom:1px dashed var(--glass-stroke);padding:var(--padding-base);border-radius:calc(var(--border-radius) - 4px);min-width:0}
      .video-info .info-item{display:flex;align-items:center;gap:.55rem;background:var(--glass-bg);border:1px solid var(--glass-stroke);border-radius:10px;padding:.55rem .7rem;margin-bottom:.55rem;transition:transform .25s ease,box-shadow .25s ease,border-color .25s ease}
      .video-info .info-item:hover{transform:translateY(-1px);box-shadow:0 10px 26px rgba(0,0,0,.4);border-color:transparent}
      .time-info{grid-area:timeInfo;border-right:1px dashed var(--glass-stroke);background:linear-gradient(180deg,rgba(255,255,255,.05),rgba(255,255,255,.02));padding:var(--padding-base);border-radius:var(--border-radius);text-align:center;transition:transform .25s ease,box-shadow .25s ease,border-color .25s ease;display:flex;flex-direction:column;gap:1rem;box-shadow:0 0 12px rgba(255,255,255,.12);border:1px solid var(--glass-stroke);min-width:0}
      .time-info:hover{transform:translateY(-1px);box-shadow:0 14px 34px rgba(0,0,0,.5);border-color:transparent}
      .greeting{font-size:1.35rem;font-weight:800;color:var(--primary-color);display:inline-flex;align-items:center;justify-content:center;gap:.5rem;padding:.6rem 1rem;background:radial-gradient(300px 200px at 50% 0,rgba(0,198,255,.18),transparent 70%),rgba(0,0,0,.25);border-radius:999px;box-shadow:0 0 12px rgba(0,198,255,.45);user-select:none}
      .digital-clock{background:rgba(0,0,0,.25);border:1px solid var(--glass-stroke);border-radius:var(--border-radius);padding:.75rem 1rem;box-shadow:0 0 14px rgba(0,198,255,.2);color:var(--text-color);user-select:none}
      .digital-clock p{margin:.15rem 0;font-weight:600;font-size:1rem;display:flex;align-items:center;gap:.5rem}
      .youtube-section{grid-area:youtubeSection;position:relative;display:flex;flex-direction:column;padding:1.25rem;gap:1rem;min-width:0}
      .transition-layer{position:absolute;inset:0;background:linear-gradient(135deg,rgba(0,198,255,.12),rgba(255,64,129,.12));backdrop-filter:blur(2px);opacity:0;pointer-events:none;transition:opacity .25s ease;z-index:5}
      .transition-layer.active{opacity:1;pointer-events:auto}
      .video-thumb{display:flex;justify-content:center;padding:.25rem}
      .video-thumb img{display:block;width:100%;max-width:420px;aspect-ratio:1/1;object-fit:cover;border-radius:18px;margin:0 auto;border:2px solid var(--glass-stroke);box-shadow:0 14px 40px rgba(0,0,0,.55);transition:transform var(--transition-duration) ease,box-shadow var(--transition-duration) ease}
      .video-thumb img:hover{transform:scale(1.04);box-shadow:0 20px 50px rgba(0,0,0,.65)}
      .video-details{margin-top:.25rem;position:relative;min-width:0}
      .video-details h3{font-weight:800;letter-spacing:.3px;color:var(--muted-text)}
      .video-details #videoTitle{font-size:1.9rem;font-weight:900;color:var(--secondary-color);text-shadow:0 0 10px rgba(255,64,129,.55);margin-top:.1rem;margin-bottom:.6rem;word-break:break-word}
      .progress-bar{position:relative;width:100%;height:12px;background:rgba(255,255,255,.1);border:1px solid var(--glass-stroke);border-radius:10px;overflow:hidden;box-shadow:inset 0 0 10px rgba(255,255,255,.25)}
      .progress-bar #progressBar{position:relative;width:0%;height:100%;background:linear-gradient(90deg,var(--primary-color) 0%,var(--secondary-color) 50%,var(--primary-color) 100%);background-size:200% 100%;animation:gradientShift 10s ease-in-out infinite;border-radius:10px 0 0 10px;overflow:hidden;transition:width .25s ease}
      .progress-bar #progressBar::before,.progress-bar #progressBar::after{content:"";position:absolute;top:50%;width:18px;height:18px;background:rgba(255,255,255,.35);border-radius:50%;transform:translateY(-50%);animation-timing-function:ease-in-out}
      .progress-bar #progressBar::before{left:12%;animation:bubbleDrift1 8s infinite}
      .progress-bar #progressBar::after{left:52%;animation:bubbleDrift2 10s infinite}
      @keyframes gradientShift{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
      @keyframes bubbleDrift1{0%{transform:translate(0,-50%)}25%{transform:translate(-4px,-53%)}50%{transform:translate(0,-47%)}75%{transform:translate(3px,-50%)}100%{transform:translate(0,-50%)}}
      @keyframes bubbleDrift2{0%{transform:translate(0,-50%)}20%{transform:translate(5px,-48%)}40%{transform:translate(-3px,-52%)}60%{transform:translate(4px,-47%)}80%{transform:translate(-2px,-50%)}100%{transform:translate(0,-50%)}}
      #toggleDescriptionButton{background:linear-gradient(135deg,#00c6ff,#66e1ff);color:#000;border:none;padding:.5rem 1.25rem;border-radius:999px;font-size:.85rem;font-weight:800;letter-spacing:.04em;text-transform:uppercase;cursor:pointer;box-shadow:0 6px 18px rgba(0,198,255,.35);transition:transform .25s ease,box-shadow .25s ease,filter .25s ease;display:block;margin:.6rem auto 0}
      #toggleDescriptionButton:hover{transform:translateY(-1px) scale(1.03);box-shadow:0 10px 28px rgba(0,143,209,.5);filter:saturate(110%)}
      #toggleDescriptionButton:active{transform:translateY(0) scale(.98)}
      #toggleDescriptionButton:focus-visible{outline:none;box-shadow:var(--focus-ring)}
      .modal-description{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(.92);width:92%;max-width:860px;opacity:0;visibility:hidden;pointer-events:none;transition:opacity .25s ease,transform .25s ease,visibility .25s ease;background:var(--modal-background);padding:var(--padding-large);border-radius:var(--border-radius);box-shadow:0 30px 80px rgba(0,0,0,.85),0 0 0 1px var(--glass-stroke) inset;z-index:5000;color:var(--text-color)}
      .modal-description.active{opacity:1;visibility:visible;pointer-events:auto;transform:translate(-50%, -50%) scale(1)}
      #descriptionModal{max-width:460px}
      .backdrop{position:fixed;inset:0;background:rgba(0,0,0,.6);opacity:0;visibility:hidden;transition:opacity .25s ease,visibility .25s ease;z-index:4000}
      .backdrop.active{opacity:1;visibility:visible}
      .status-boxes{position:absolute;top:8px;right:8px;display:flex;gap:8px;z-index:10;user-select:none}
      .status-box{padding:.45rem .85rem;font-weight:900;font-size:.9rem;text-align:center;border-radius:12px;color:#aaa;background-color:#1a1a1a;border:2px solid #3a3a3a;transition:all .25s ease;text-transform:uppercase;letter-spacing:.04em;position:relative}
      .status-box.live.active{background-color:#e60000;color:#fff;border-color:#ff3333;box-shadow:0 0 10px #ff1a1a,inset 0 0 18px #ff4d4d}
      .status-box.live.active::before{content:"";position:absolute;top:50%;left:50%;width:80px;height:80px;background:rgba(230,0,0,.35);border-radius:50%;transform:translate(-50%,-50%);animation:radioWave 2s infinite ease-out;pointer-events:none;z-index:-1}
      .status-box.paused.active{background-color:#3b3b3b;color:#fff;border-color:var(--secondary-color);box-shadow:0 0 10px var(--secondary-color),inset 0 0 16px #ff73a0}
      .status-box.live:not(.active),.status-box.paused:not(.active){color:#555;background-color:#111;border-color:#222;box-shadow:none}
      @keyframes radioWave{0%{transform:translate(-50%,-50%) scale(.55);opacity:.6}70%{opacity:0}100%{transform:translate(-50%,-50%) scale(1.55);opacity:0}}
      .weather-info{border-bottom:1px dashed var(--glass-stroke);background:rgba(0,0,0,.6);padding:18px;border-radius:14px;text-align:center;color:#fff;box-shadow:0 8px 24px rgba(0,0,0,.45);font-weight:700;display:flex;flex-direction:column;align-items:center;gap:.35rem;grid-area:weatherSection;border:1px solid var(--glass-stroke)}
      .weather-info img{width:60px;height:60px;filter:drop-shadow(0 0 6px var(--primary-color))}
      .weather-info p{margin:0;font-weight:700}
      .offline-indicator{display:none;color:#ff5c5c;font-weight:800;font-size:1.15rem;text-align:center;padding:1rem;background:rgba(255,0,0,.15);border-radius:var(--border-radius);box-shadow:0 0 16px #ff5c5c;transition:opacity .35s ease;border:1px solid rgba(255,92,92,.35)}
      .offline-indicator.visible{display:block;opacity:1}
      .footer{background:rgba(0,0,0,.8);padding:var(--padding-base);text-align:center;font-size:var(--small-font-size);color:#bbb;position:fixed;bottom:0;left:0;width:100%;z-index:5000;box-shadow:0 -8px 14px rgba(0,0,0,.45);border-top:1px solid var(--glass-stroke);opacity:0;animation:fadeInUp var(--animation-duration) ease-out .6s forwards}
      .manage-consent-button{background:none;border:none;color:var(--secondary-color);cursor:pointer;font-size:var(--small-font-size);margin-top:.45rem;text-decoration:underline}
      .manage-consent-button:hover{color:var(--primary-color)}
      .manage-consent-button:focus-visible{outline:none;box-shadow:var(--focus-ring);border-radius:8px}
      #consentModal{opacity:0;visibility:hidden;pointer-events:none;transition:opacity .25s ease,visibility .25s ease,transform .25s ease;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(.92);z-index:10000;background:#111;padding:2rem 2.5rem;border-radius:var(--border-radius);box-shadow:0 30px 80px rgba(0,0,0,.9),0 0 0 1px var(--glass-stroke) inset;color:var(--text-color);max-width:460px;width:92%;font-weight:700;font-size:1rem}
      #consentModal h2{font-size:1.8rem;margin-bottom:1rem;color:var(--secondary-color);text-shadow:0 0 10px rgba(255,64,129,.6);display:flex;align-items:center;gap:.5rem}
      #consentModal p{margin-bottom:1.5rem;line-height:1.5;color:var(--muted-text)}
      #consentModal .consent-buttons{display:flex;justify-content:flex-end;gap:.75rem}
      #consentModal .consent-button{background:linear-gradient(135deg,var(--secondary-color),#ff76a4);color:var(--text-color);border:none;padding:.6rem 1.15rem;border-radius:10px;cursor:pointer;font-weight:900;font-size:1rem;transition:transform .2s ease,box-shadow .2s ease,filter .2s ease;border:1px solid var(--glass-stroke)}
      #consentModal .consent-button:hover{transform:translateY(-1px);filter:saturate(110%)}
      #consentModal .consent-button:focus-visible{outline:none;box-shadow:var(--focus-ring)}
      #consentModal.active{opacity:1;visibility:visible;pointer-events:auto;transform:translate(-50%,-50%) scale(1)}
      .history-wrap{margin-top:12px}
      .history-header{display:flex;align-items:center;justify-content:space-between;gap:.5rem;font-weight:900;opacity:.95}
      .history-header>div:first-child{display:inline-flex;align-items:center;gap:.5rem}
      .history-actions{display:flex;align-items:center;gap:.5rem}
      .history-more{background:linear-gradient(135deg,#00c6ff,#33d6ff);color:#001521;font-weight:900;border:none;border-radius:999px;padding:.6rem 1rem;cursor:pointer;transition:transform .2s ease,box-shadow .25s ease,filter .2s ease;display:inline-flex;align-items:center;gap:.5rem;white-space:nowrap;box-shadow:0 10px 24px rgba(0,198,255,.45),0 0 0 1px var(--glass-stroke) inset;letter-spacing:.02em}
      .history-more:hover{transform:translateY(-1px) scale(1.03);filter:saturate(112%);box-shadow:0 14px 30px rgba(0,198,255,.55)}
      .history-more:active{transform:translateY(0) scale(.98)}
      .history-more:disabled{opacity:.55;cursor:not-allowed}
      .history-scroller{margin-top:8px;display:flex;justify-content:center;gap:10px;overflow:hidden;padding-bottom:6px}
      .history-scroller::-webkit-scrollbar{display:none}
      .hist-item{background:var(--glass-bg);border:1px solid var(--glass-stroke);border-radius:14px;padding:8px;display:flex;flex-direction:column;gap:6px;cursor:pointer;transition:transform .2s ease,background .2s ease,box-shadow .2s ease,border-color .2s ease;width:150px;box-shadow:0 8px 24px rgba(0,0,0,.35)}
      .hist-item:hover{transform:translateY(-2px);background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));box-shadow:0 12px 30px rgba(0,0,0,.5);border-color:transparent}
      .hist-thumb{width:100%;aspect-ratio:16/9;object-fit:cover;border-radius:10px;border:1px solid var(--glass-stroke);box-shadow:0 6px 18px rgba(0,0,0,.4)}
      .hist-title{font-size:.85rem;line-height:1.2;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;font-weight:800}
      .hist-meta{font-size:.72rem;opacity:.75;color:var(--muted-text);font-weight:700}
      #historyModal h4{font-size:1.25rem;font-weight:900;letter-spacing:.3px;margin-bottom:.5rem}
      .history-modal-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px;margin-top:.25rem;max-height:65vh;overflow:auto;padding-right:.25rem}
      .history-modal-close{position:absolute;top:10px;right:12px;border:none;background:transparent;color:#fff;font-size:1.15rem;cursor:pointer;transition:transform .2s ease,color .2s ease}
      .history-modal-close:hover{transform:rotate(90deg);color:var(--secondary-color)}
      .history-modal-close:focus-visible{outline:none;box-shadow:var(--focus-ring);border-radius:8px}
      ::-webkit-scrollbar{width:8px;height:8px}
      ::-webkit-scrollbar-thumb{background:linear-gradient(180deg,var(--secondary-color),var(--primary-color));border-radius:4px}
      ::-webkit-scrollbar-track{background:transparent}
      @keyframes fadeInPage{from{opacity:0}to{opacity:1}}
      @keyframes fadeInUp{0%{opacity:0;transform:translateY(20px)}100%{opacity:1;transform:translateY(0)}}
      @media(max-width:1100px){.now-playing-grid{grid-template-columns:1.3fr 1fr;grid-template-areas:"youtubeSection youtubeSection" "videoInfo timeInfo" "weatherSection weatherSection"}.status-boxes{top:8px;right:8px}}
      @media(max-width:700px){.site-title{font-size:2.25rem}.now-playing-card{padding:1rem}.video-details #videoTitle{font-size:1.45rem}.hist-item{width:140px}}
      @media(prefers-reduced-motion:reduce){*{animation-duration:.001ms!important;animation-iteration-count:1!important;transition-duration:0ms!important;scroll-behavior:auto!important}}
    </style>
  </head>
  <body>
    <canvas id="soundWaveCanvas" aria-hidden="true"></canvas>
    <div class="page-container" id="pageContainer">
      <header class="title-bar" id="titleBar">
        <div class="container">
          <div class="left-section"></div>
          <div class="title-wrapper">
            <a href="/" aria-label="Home" class="logo-link">
              <span class="site-title">Miku.dev</span>
              <div class="visualizer-wrapper">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 150 100" class="visualizer">
                  <g>
                    <rect x="10" y="70" width="15" height="30" fill="#00c6ff">
                      <animate attributeName="height" values="30;60;30" dur="0.8s" repeatCount="indefinite"/>
                      <animate attributeName="y" values="70;40;70" dur="0.8s" repeatCount="indefinite"/>
                    </rect>
                    <rect x="35" y="60" width="15" height="40" fill="#ff4081">
                      <animate attributeName="height" values="40;80;40" dur="1s" repeatCount="indefinite"/>
                      <animate attributeName="y" values="60;20;60" dur="1s" repeatCount="indefinite"/>
                    </rect>
                    <rect x="60" y="80" width="15" height="20" fill="#00c6ff">
                      <animate attributeName="height" values="20;50;20" dur="0.6s" repeatCount="indefinite"/>
                      <animate attributeName="y" values="80;50;80" dur="0.6s" repeatCount="indefinite"/>
                    </rect>
                    <rect x="85" y="50" width="15" height="50" fill="#ff4081">
                      <animate attributeName="height" values="50;90;50" dur="1.2s" repeatCount="indefinite"/>
                      <animate attributeName="y" values="50;10;50" dur="1.2s" repeatCount="indefinite"/>
                    </rect>
                    <rect x="110" y="70" width="15" height="30" fill="#00c6ff">
                      <animate attributeName="height" values="30;60;30" dur="0.9s" repeatCount="indefinite"/>
                      <animate attributeName="y" values="70;40;70" dur="0.9s" repeatCount="indefinite"/>
                    </rect>
                    <rect x="135" y="60" width="15" height="40" fill="#ff4081">
                      <animate attributeName="height" values="40;80;40" dur="1.1s" repeatCount="indefinite"/>
                      <animate attributeName="y" values="60;20;60" dur="1.1s" repeatCount="indefinite"/>
                    </rect>
                  </g>
                </svg>
              </div>
            </a>
          </div>
          <div class="right-section">
            <button class="menu-button" id="menuButton" aria-label="Open Menu"><i class="fas fa-music"></i></button>
          </div>
        </div>
      </header>

      <nav class="overlay-menu" id="overlayMenu">
        <button class="close-overlay" id="closeOverlay" aria-label="Close Menu"><i class="fas fa-times"></i></button>
        <div class="overlay-content">
          <a href="/auth" aria-label="Admin Login"><i class="fas fa-user-lock"></i> Admin Login</a>
          <a href="#aboutMe" aria-label="About Me"><i class="fas fa-info-circle"></i> About Me</a>
          <div class="personality-options">
            <button id="personalityOption1" class="personality-button"><i class="fas fa-music"></i> Melody</button>
            <button id="personalityOption2" class="personality-button"><i class="fas fa-headphones"></i> Harmony</button>
            <button id="personalityOption3" class="personality-button"><i class="fas fa-microphone"></i> Rhythm</button>
          </div>
        </div>
      </nav>

      <section class="now-playing-container">
        <div class="now-playing-card" id="nowPlayingCard">
          <div class="now-playing-grid">
            <div class="video-info">
              <div class="info-item"><i class="fas fa-tv"></i><span id="channelName">Loading…</span></div>
              <div class="info-item"><i class="fas fa-eye"></i><span id="viewCount">Loading…</span></div>
              <div class="info-item"><i class="fas fa-thumbs-up"></i><span id="likeCount">Loading…</span></div>
              <div class="info-item"><i class="fas fa-calendar-day"></i><span id="publishedDate">Loading…</span></div>
              <div class="info-item"><i class="fas fa-tag"></i><span id="videoCategory">Loading…</span></div>
            </div>

            <div class="time-info">
              <div class="greeting-container">
                <p class="greeting"><i class="fas fa-sun"></i> <span id="greeting-text">Good Morning!</span></p>
              </div>
              <div class="clock-container">
                <div class="digital-clock">
                  <p id="local-time"><i class="fas fa-clock"></i> 00:00:00</p>
                  <p id="current-date"><i class="fas fa-calendar-alt"></i> 1 January 2025</p>
                  <p id="day-of-week"><i class="fas fa-calendar-day"></i> Wednesday</p>
                  <p id="time-zone"><i class="fas fa-globe"></i> UTC</p>
                </div>
              </div>
            </div>

            <div class="youtube-section" id="youtubeSection">
              <div class="transition-layer" id="ytTransition"></div>
              <div class="video-thumb">
                <img id="videoThumbnailImage" class="thumb-img" src="" alt="Thumbnail" loading="lazy"/>
              </div>
              <div class="video-details">
                <h3>Currently Playing</h3>
                <p id="videoTitle">Loading…</p>
                <div class="progress-bar"><div id="progressBar"></div></div>
                <button id="toggleDescriptionButton"><i class="fas fa-info-circle"></i> Show Description</button>
                <div id="backdrop" class="backdrop" aria-hidden="true"></div>
                <div id="descriptionModal" class="modal-description" role="dialog" aria-modal="true" aria-labelledby="descriptionModalTitle" aria-describedby="descriptionModalDescription">
                  <h4 id="descriptionModalTitle">Description</h4>
                  <p id="descriptionModalDescription">Loading description…</p>
                </div>
              </div>
              <div class="status-boxes">
                <div id="liveIndicator" class="status-box live">Live</div>
                <div id="pauseIndicator" class="status-box paused">Paused</div>
              </div>
            </div>

            <aside class="weather-info">
              <img id="weather-icon" src="" alt="Weather Icon" loading="lazy"/>
              <p id="weather-description">Loading…</p>
              <p id="temperature">--°C</p>
              <p id="humidity">Humidity: --%</p>
              <p id="wind-speed">Wind: -- m/s</p>
            </aside>

            <div class="history-wrap">
              <div class="history-header">
                <div><i class="fas fa-clock"></i> Recent</div>
                <div class="history-actions">
                  <button id="historyMoreBtn" class="history-more"><i class="fas fa-list"></i> More</button>
                </div>
              </div>
              <div id="historyScroller" class="history-scroller"></div>
            </div>
          </div>

          <div id="offline-indicator" class="offline-indicator"><i class="fas fa-signal-slash"></i> Offline</div>
        </div>
      </section>

      <footer class="footer">
        <div class="container">
          <p>&copy; 2024 MikuMiku. All rights reserved.</p>
          <button id="manageConsentFooter" class="manage-consent-button"><i class="fas fa-cookie-bite"></i> Manage Cookie Preferences</button>
        </div>
      </footer>

      <div id="consentModal" class="modal" aria-hidden="true" role="dialog" aria-labelledby="consentModalTitle" aria-describedby="consentModalDescription">
        <div class="modal-content">
          <button class="close-button" id="closeConsentModal" aria-label="Close Consent Modal"><i class="fas fa-times"></i></button>
          <h2 id="consentModalTitle"><i class="fas a-cookie"></i> Cookie Consent</h2>
          <p id="consentModalDescription">I use cookies stored in your browser to enhance your experience on my personal website. These cookies are essential for the website's functionality. By clicking "Accept," you consent to their use. You can also manage your cookie preferences in the "Manage Cookie Preferences" section.</p>
          <div class="consent-buttons">
            <button id="acceptConsent" class="consent-button"><i class="fas fa-check"></i> Accept</button>
            <button id="declineConsent" class="consent-button"><i class="fas fa-times"></i> Decline</button>
          </div>
        </div>
      </div>

      <div id="historyBackdrop" class="backdrop" aria-hidden="true"></div>
      <div id="historyModal" class="modal-description" role="dialog" aria-modal="true" aria-labelledby="historyModalTitle">
        <button id="closeHistoryModal" class="history-modal-close" aria-label="Close"><i class="fas fa-times"></i></button>
        <h4 id="historyModalTitle">More Recently Played</h4>
        <div id="historyModalGrid" class="history-modal-grid"></div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.1/socket.io.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script>
      document.addEventListener("DOMContentLoaded",function(){
        const pageContainer=document.getElementById("pageContainer");if(pageContainer)pageContainer.classList.add("loaded");
        const titleBar=document.getElementById("titleBar");if(titleBar)window.addEventListener("scroll",function(){titleBar.classList.toggle("scrolled",window.scrollY>50)});
        const menuButton=document.getElementById("menuButton"),overlayMenu=document.getElementById("overlayMenu"),closeOverlay=document.getElementById("closeOverlay");
        if(menuButton&&overlayMenu)menuButton.addEventListener("click",function(e){e.stopPropagation();overlayMenu.classList.add("active");document.body.classList.add("overlay-active")});
        if(closeOverlay&&overlayMenu)closeOverlay.addEventListener("click",function(e){e.stopPropagation();overlayMenu.classList.remove("active");document.body.classList.remove("overlay-active")});
        window.addEventListener("click",function(e){if(e.target===overlayMenu){overlayMenu.classList.remove("active");document.body.classList.remove("overlay-active")}});
        const pb=document.getElementById("toggleDescriptionButton"),dm=document.getElementById("descriptionModal"),bd=document.getElementById("backdrop");
        function openDesc(){dm.classList.add("active");bd.classList.add("active");document.body.classList.add("modal-open");localStorage.setItem("descriptionModalOpen","true")}
        function closeDesc(){dm.classList.remove("active");bd.classList.remove("active");document.body.classList.remove("modal-open");localStorage.setItem("descriptionModalOpen","false")}
        if(localStorage.getItem("descriptionModalOpen")==="true"){openDesc()}else{closeDesc()}
        if(pb)pb.addEventListener("click",function(){dm.classList.contains("active")?closeDesc():openDesc()});
        if(bd)bd.addEventListener("click",closeDesc);
        document.addEventListener("keydown",function(e){if(e.key==="Escape"&&dm.classList.contains("active"))closeDesc()})
      });
    </script>

    <script>
      document.addEventListener("DOMContentLoaded",function(){
        function tick(){const now=new Date();const t=now.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"});const d=now.toLocaleDateString(undefined,{day:"2-digit",month:"long",year:"numeric"});const w=now.toLocaleDateString(undefined,{weekday:"long"});const lt=document.getElementById("local-time"),cd=document.getElementById("current-date"),dw=document.getElementById("day-of-week");if(lt)lt.textContent=t;if(cd)cd.textContent=d;if(dw)dw.textContent=w}
        setInterval(tick,1000);tick()
      });
    </script>

    <script>
      document.addEventListener("DOMContentLoaded",function(){
        async function fetchWeather(){
          try{const r=await fetch("/api/weather?city="+encodeURIComponent("Leeds"));const data=await r.json();if(data.error)throw new Error(data.error);render(data)}
          catch(e){const ic=document.getElementById("weather-icon");if(ic)ic.style.display="none";const de=document.getElementById("weather-description");if(de)de.innerText="Unable to fetch weather data."}
        }
        function render(d){
          const desc=d.weather[0].description,temp=Math.round(d.main.temp),hum=d.main.humidity,wind=d.wind.speed,icon=d.weather[0].icon,iconUrl="https://openweathermap.org/img/wn/"+icon+"@2x.png";
          document.getElementById("weather-description").innerText="Condition: "+desc;
          document.getElementById("temperature").innerText="Temperature: "+temp+"°C";
          document.getElementById("humidity").innerText="Humidity: "+hum+"%";
          document.getElementById("wind-speed").innerText="Wind: "+wind+" m/s";
          const ic=document.getElementById("weather-icon");if(ic){ic.src=iconUrl;ic.style.display="block"}
        }
        setInterval(fetchWeather,3600000);fetchWeather()
      });
    </script>

    <script>
      document.addEventListener("DOMContentLoaded",function(){
        const card=document.getElementById("nowPlayingCard"),yt=document.getElementById("youtubeSection"),offline=document.getElementById("offline-indicator"),titleEl=document.getElementById("videoTitle"),thumb=document.getElementById("videoThumbnailImage"),ch=document.getElementById("channelName"),vc=document.getElementById("viewCount"),lc=document.getElementById("likeCount"),pd=document.getElementById("publishedDate"),cat=document.getElementById("videoCategory"),bar=document.getElementById("progressBar"),live=document.getElementById("liveIndicator"),paused=document.getElementById("pauseIndicator"),desc=document.getElementById("descriptionModalDescription"),moreBtn=document.getElementById("historyMoreBtn"),backdrop=document.getElementById("historyBackdrop"),histModal=document.getElementById("historyModal"),histGrid=document.getElementById("historyModalGrid"),scroller=document.getElementById("historyScroller"),transition=document.getElementById("ytTransition");
        let currentId=null,lastPct=null,statsTimer=null;

        function num(n){if(typeof n==="string")n=n.replace(/,/g,"");const x=Number(n);return isNaN(x)?"N/A":x.toLocaleString()}
        function setProgress(d){
          if(!bar)return;
          if(d.isLive){bar.style.width="100%";lastPct=100;return}
          const dur=Number(d.duration),cur=Number(d.currentTime),pct=isFinite(cur)&&isFinite(dur)&&dur>0?Math.max(0,Math.min(100,(cur/dur)*100)):null;
          if(pct!=null){bar.style.width=pct+"%";lastPct=pct}else if(lastPct==null){bar.style.width="0%"}
        }
        function setStates(d){
          const isLive=!!d.isLive,isPaused=!!d.isPaused;
          if(live)live.classList.toggle("active",isLive);
          if(paused)paused.classList.toggle("active",isPaused);
        }
        function goOnline(){
          if(offline)offline.classList.remove("visible");
          if(card)card.classList.remove("offline");
          if(yt)yt.style.display="block";
        }
        function goOffline(){
          if(offline)offline.classList.add("visible");
          if(card)card.classList.add("offline");
        }
        function applyVideo(d){
          currentId=d.videoId||null;
          if(titleEl)titleEl.textContent=d.title||"";
          if(ch)ch.textContent=d.channelTitle||"";
          if(vc)vc.textContent=num(d.viewCount);
          if(lc)lc.textContent=num(d.likeCount);
          if(pd)pd.textContent=d.publishedAt?new Date(d.publishedAt).toLocaleDateString():pd.textContent;
          if(cat)cat.textContent=d.category||"";
          if(desc)desc.textContent=d.description||"";
          if(thumb){if(d.thumbnail){thumb.src=d.thumbnail;thumb.style.display="block"}}
          goOnline();
          setProgress(d);
          setStates(d);
          localStorage.setItem("currentVideoTitle",titleEl?titleEl.textContent:"");
          localStorage.setItem("currentVideoThumbnail",thumb&&thumb.src?thumb.src:"");
          localStorage.setItem("currentVideoChannel",ch?ch.textContent:"");
          localStorage.setItem("currentVideoViews",vc?vc.textContent:"");
          localStorage.setItem("currentVideoLikes",lc?lc.textContent:"");
          localStorage.setItem("currentVideoPublished",pd?pd.textContent:"");
          localStorage.setItem("currentVideoCategory",cat?cat.textContent:"");
          localStorage.setItem("currentVideoDescription",desc?desc.textContent:"");
          pushHistory(d);
        }
        function showTransition(d){
          yt.classList.add("entering");
          transition.classList.add("active");
          const image = new Image();
          const loaded = new Promise(r=>{image.onload=()=>r(true);image.onerror=()=>r(false);if(d.thumbnail)image.src=d.thumbnail+"?t="+Date.now()});
          const timeout = new Promise(r=>setTimeout(()=>r(false),800));
          Promise.race([loaded,timeout]).then(()=>{applyVideo(d);setTimeout(()=>{transition.classList.remove("active");yt.classList.remove("entering")},180)})
        }

        function histLoad(){const raw=localStorage.getItem("npHistory");try{return raw?JSON.parse(raw):[]}catch{return[]}}
        function histRender(items){
          scroller.innerHTML="";items.slice(0,3).forEach(x=>scroller.appendChild(histItem(x)));
          moreBtn.disabled=items.length<=3;
          histGrid.innerHTML="";items.slice(3).forEach(x=>histGrid.appendChild(histItem(x)));
        }
        function histItem(x){
          const c=document.createElement("div");c.className="hist-item";c.dataset.videoId=x.videoId;
          const i=document.createElement("img");i.className="hist-thumb";i.src=x.thumbnail||"";
          const t=document.createElement("div");t.className="hist-title";t.textContent=x.title||"";
          const m=document.createElement("div");m.className="hist-meta";m.textContent=x.channelTitle||"";
          c.appendChild(i);c.appendChild(t);c.appendChild(m);
          c.addEventListener("click",function(){
            const d={videoId:x.videoId,title:x.title,thumbnail:x.thumbnail,channelTitle:x.channelTitle,viewCount:vc?vc.textContent:"",likeCount:lc?lc.textContent:"",publishedAt:x.publishedAt,category:x.category,description:desc?desc.textContent:"",duration:0,currentTime:0,isLive:false,isPaused:true};
            applyVideo(d);toggleHistory(false)
          });
          return c
        }
        function pushHistory(d){
          const cur=histLoad().filter(y=>y.videoId!==d.videoId);
          cur.unshift({videoId:d.videoId||"",title:d.title||"",thumbnail:d.thumbnail||"",channelTitle:d.channelTitle||"",publishedAt:d.publishedAt||"",category:d.category||""});
          const next=cur.slice(0,20);
          localStorage.setItem("npHistory",JSON.stringify(next));
          histRender(next)
        }
        function toggleHistory(state){
          if(state){backdrop.classList.add("active");histModal.classList.add("active");document.body.classList.add("modal-open")}
          else{backdrop.classList.remove("active");histModal.classList.remove("active");document.body.classList.remove("modal-open")}
        }

        histRender(histLoad());
        toggleHistory(false);

        moreBtn.addEventListener("click",function(){toggleHistory(true)});
        backdrop.addEventListener("click",function(){toggleHistory(false)});
        document.getElementById("closeHistoryModal").addEventListener("click",function(){toggleHistory(false)});
        document.addEventListener("keydown",function(e){if(e.key==="Escape"&&histModal.classList.contains("active"))toggleHistory(false)});

        const socket=io();
        socket.on("connect",function(){goOnline()});
        socket.on("disconnect",function(){goOffline()});
        socket.on("presenceUpdate",function(d){
          if(d.presenceType==="offline"){goOffline()}
          else if(d.presenceType==="video"){if(d.videoId===currentId){goOnline();setProgress(d);setStates(d)}else{showTransition(d);refreshStatsTimer()}}
          else if(d.presenceType==="browsing"){if(titleEl)titleEl.textContent=d.title||titleEl.textContent;if(thumb){if(d.thumbnail){thumb.src=d.thumbnail;thumb.style.display="block"}}goOnline();setStates({isLive:false,isPaused:false})}
        });

        function refreshStatsTimer(){
          if(statsTimer){clearInterval(statsTimer);statsTimer=null}
          const liveOn=live&&live.classList.contains("active");
          if(liveOn){statsTimer=setInterval(fetchLiveStats,10000)}
        }
        async function fetchLiveStats(){
          if(!currentId)return;
          try{
            const r=await fetch("/api/youtube/stats?videoId="+encodeURIComponent(currentId));
            if(!r.ok)return;
            const j=await r.json();
            if(typeof j.viewCount!=="undefined"&&vc)vc.textContent=num(j.viewCount);
            if(typeof j.likeCount!=="undefined"&&lc)lc.textContent=num(j.likeCount)
          }catch{}
        }
        setInterval(refreshStatsTimer,5000);

        setTimeout(function(){
          if(!titleEl||!titleEl.textContent||titleEl.textContent==="Loading…"){
            const t=localStorage.getItem("currentVideoTitle");if(t&&titleEl)titleEl.textContent=t;
            const s=localStorage.getItem("currentVideoThumbnail");if(s&&thumb){thumb.src=s;thumb.style.display="block"}
            const cN=localStorage.getItem("currentVideoChannel"),vN=localStorage.getItem("currentVideoViews"),lN=localStorage.getItem("currentVideoLikes"),pN=localStorage.getItem("currentVideoPublished"),catN=localStorage.getItem("currentVideoCategory"),dN=localStorage.getItem("currentVideoDescription");
            if(ch&&cN)ch.textContent=cN;if(vc&&vN)vc.textContent=vN;if(lc&&lN)lc.textContent=lN;if(pd&&pN)pd.textContent=pN;if(cat&&catN)cat.textContent=catN;if(desc&&dN)desc.textContent=dN
          }
        },0)
      });
    </script>
  </body>
</html>
