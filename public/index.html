<script>
document.addEventListener("DOMContentLoaded",function(){
  if(!sessionStorage.getItem("lsCleared")){localStorage.clear();sessionStorage.setItem("lsCleared","1")}
  document.querySelectorAll(".visualizer animate").forEach(function(n){n.remove()})
})
</script>

<script>
document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("pageContainer");e&&e.classList.add("loaded");const t=document.getElementById("titleBar");t&&window.addEventListener("scroll",function(){t.classList.toggle("scrolled",window.scrollY>50)});const n=document.getElementById("menuButton"),o=document.getElementById("overlayMenu"),a=document.getElementById("closeOverlay");n&&o&&n.addEventListener("click",function(e){e.stopPropagation(),o.classList.add("active"),document.body.classList.add("overlay-active")}),a&&o&&a.addEventListener("click",function(e){e.stopPropagation(),o.classList.remove("active"),document.body.classList.remove("overlay-active")}),window.addEventListener("click",function(e){e.target===o&&(o.classList.remove("active"),document.body.classList.remove("overlay-active"))});const i=document.querySelectorAll(".personality-button"),d=document.querySelector(".site-title");i.length&&d&&i.forEach(e=>{e.addEventListener("click",function(){const t=e.textContent.trim();"Melody"===t?d.style.color="#ff4081":"Harmony"===t?d.style.color="#00c6ff":"Rhythm"===t?d.style.color="#ffffff":d.style.color="#00c6ff",i.forEach(e=>e.classList.remove("active")),e.classList.add("active")})})});
</script>

<script>
document.addEventListener("DOMContentLoaded",function(){
  const key="lastVisitTimestamp";const now=Date.now();const lastVisit=localStorage.getItem(key);let message;if(lastVisit){const diffMs=now-parseInt(lastVisit,10);const diffMin=Math.floor(diffMs/60000);const diffHr=Math.floor(diffMin/60);const diffDay=Math.floor(diffHr/24);if(diffDay>0)message=`Last visited ${diffDay} day${diffDay>1?'s':''} ago`;else if(diffHr>0)message=`Last visited ${diffHr} hour${diffHr>1?'s':''} ago`;else if(diffMin>0)message=`Last visited ${diffMin} minute${diffMin>1?'s':''} ago`;else message="Last visited just now"}else{message="This is your first visit!"}localStorage.setItem(key,now.toString());const footerContainer=document.querySelector(".footer .container");if(footerContainer){const span=document.createElement("span");span.style.display="block";span.style.marginTop="4px";span.style.opacity="0.8";span.textContent=message;footerContainer.appendChild(span)}
})
</script>

<script>
(function(){
  const cfg={name:"cookieConsent",days:365,path:"/",modalId:"consentModal",acceptId:"acceptConsent",declineId:"declineConsent",manageIds:["manageConsentFooter"],closeId:"closeConsentModal"}
  const modal=document.getElementById(cfg.modalId)
  const btnAccept=document.getElementById(cfg.acceptId)
  const btnDecline=document.getElementById(cfg.declineId)
  const btnClose=document.getElementById(cfg.closeId)
  const manageBtns=cfg.manageIds.map(id=>document.getElementById(id)).filter(Boolean)
  function setCookie(name,value,days,path){let exp="";if(typeof days==="number"&&isFinite(days)){const d=new Date();d.setTime(d.getTime()+days*24*60*60*1000);exp="; expires="+d.toUTCString()}const sec=location.protocol==="https:"?"; Secure":"";document.cookie=name+"="+encodeURIComponent(value)+exp+"; path="+(path||"/")+"; SameSite=Lax"+sec}
  function openModal(){if(!modal)return;modal.classList.add("active");document.body.classList.add("modal-active");modal.setAttribute("aria-hidden","false")}
  function closeModal(){if(!modal)return;modal.classList.remove("active");document.body.classList.remove("modal-active");modal.setAttribute("aria-hidden","true")}
  function init(){const existing=document.cookie.includes(cfg.name+"=");if(!existing){openModal()}manageBtns.forEach(b=>b.addEventListener("click",e=>{e.preventDefault();openModal()}));if(btnAccept)btnAccept.addEventListener("click",function(){setCookie(cfg.name,JSON.stringify({necessary:true}),cfg.days,cfg.path);closeModal()});if(btnDecline)btnDecline.addEventListener("click",function(){setCookie(cfg.name,JSON.stringify({necessary:false}),cfg.days,cfg.path);closeModal()});if(btnClose)btnClose.addEventListener("click",function(){closeModal()});window.addEventListener("click",function(e){if(e.target===modal)closeModal()});document.addEventListener("keydown",function(e){if(e.key==="Escape"&&modal.classList.contains("active"))closeModal()})}
  document.addEventListener("DOMContentLoaded",init)
})();
</script>

<script>
document.addEventListener("DOMContentLoaded",function(){
  const t=localStorage.getItem("currentVideoTitle"),u=localStorage.getItem("currentVideoThumbnail");if(t){const e=document.getElementById("videoTitle");e&&(e.textContent=t)}if(u){const e=document.getElementById("videoThumbnailImage");e&&(e.src=u,e.style.display="block")}const n=localStorage.getItem("currentVideoChannel"),o=localStorage.getItem("currentVideoViews"),a=localStorage.getItem("currentVideoLikes"),i=localStorage.getItem("currentVideoPublished"),d=localStorage.getItem("currentVideoCategory"),l=localStorage.getItem("currentVideoDescription");const c=document.getElementById("channelName"),s=document.getElementById("viewCount"),r=document.getElementById("likeCount"),m=document.getElementById("publishedDate"),g=document.getElementById("videoCategory"),f=document.getElementById("descriptionModalDescription");c&&n&&(c.textContent=n);s&&o&&(s.textContent=o);r&&a&&(r.textContent=a);m&&i&&(m.textContent=i);g&&d&&(g.textContent=d);f&&l&&(f.textContent=l)
})
</script>

<script>
document.addEventListener("DOMContentLoaded",function(){
  const e=document.getElementById("toggleDescriptionButton"),t=document.getElementById("descriptionModal"),n=document.getElementById("backdrop");function o(){t.classList.add("active");n.classList.add("active");document.body.classList.add("modal-open");localStorage.setItem("descriptionModalOpen","true")}function a(){t.classList.remove("active");n.classList.remove("active");document.body.classList.remove("modal-open");localStorage.setItem("descriptionModalOpen","false")}localStorage.getItem("descriptionModalOpen")==="true"?o():a();e.addEventListener("click",function(){t.classList.contains("active")?a():o()});n.addEventListener("click",a);document.addEventListener("keydown",function(e){if(e.key==="Escape"&&t.classList.contains("active"))a()})
})
</script>

<script>
document.addEventListener("DOMContentLoaded",function(){
  function e(){const e=new Date,t=e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),n=document.getElementById("local-time");n&&(n.textContent=t);const o=e.toLocaleDateString(void 0,{day:"2-digit",month:"long",year:"numeric"}),a=document.getElementById("current-date");a&&(a.textContent=o);const i=e.toLocaleDateString(void 0,{weekday:"long"}),d=document.getElementById("day-of-week");d&&(d.textContent=i)}setInterval(e,1000);e()
})
</script>

<script>
document.addEventListener("DOMContentLoaded",function(){
  async function e(){try{const e=await fetch("/api/weather?city="+encodeURIComponent("Leeds")),t=await e.json();if(t.error)throw new Error(t.error);n(t)}catch(e){const t=document.getElementById("weather-icon");t&&(t.style.display="none");const n=document.getElementById("weather-description");n&&(n.innerText="Unable to fetch weather data.")}}
  function n(e){const n=e.weather[0].description,o=Math.round(e.main.temp),a=e.main.humidity,i=e.wind.speed,d=e.weather[0].icon,l="https://openweathermap.org/img/wn/"+d+"@2x.png";document.getElementById("weather-description").innerText="Condition: "+n;document.getElementById("temperature").innerText="Temperature: "+o+"°C";document.getElementById("humidity").innerText="Humidity: "+a+"%";document.getElementById("wind-speed").innerText="Wind: "+i+" m/s";const c=document.getElementById("weather-icon");c&&(c.src=l,c.style.display="block");u(d)}
  function u(code){const a=document.getElementById("ambientLayer");let c1="#00c6ff";if(code.startsWith("01"))c1="#ffd166";else if(code.startsWith("02")||code.startsWith("03"))c1="#8ecae6";else if(code.startsWith("04"))c1="#577590";else if(code.startsWith("09")||code.startsWith("10"))c1="#4dabf7";else if(code.startsWith("11"))c1="#7209b7";else if(code.startsWith("13"))c1="#bde0fe";else if(code.startsWith("50"))c1="#adb5bd";a.style.setProperty("--c1",c1);a.style.setProperty("--x","50%");a.style.setProperty("--y","50%")}
  setInterval(e,3600000);e()
})
</script>

<script>
document.addEventListener("DOMContentLoaded",function(){
  const card=document.getElementById("nowPlayingCard"),yt=document.getElementById("youtubeSection"),offline=document.getElementById("offline-indicator"),titleEl=document.getElementById("videoTitle"),thumb=document.getElementById("videoThumbnailImage"),thumbSk=document.getElementById("thumbSkeleton"),titleSk=document.getElementById("titleSkeleton"),lineSk=document.getElementById("lineSkeleton"),chan=document.getElementById("channelName"),views=document.getElementById("viewCount"),likes=document.getElementById("likeCount"),pub=document.getElementById("publishedDate"),cat=document.getElementById("videoCategory"),bar=document.getElementById("progressBar"),live=document.getElementById("liveIndicator"),pausedEl=document.getElementById("pauseIndicator"),desc=document.getElementById("descriptionModalDescription"),descBtn=document.getElementById("toggleDescriptionButton"),layer=document.getElementById("ytTransition"),histScroller=document.getElementById("historyScroller"),histMore=document.getElementById("historyMoreBtn"),histBackdrop=document.getElementById("historyBackdrop"),histModal=document.getElementById("historyModal"),histGrid=document.getElementById("historyModalGrid"),histClose=document.getElementById("closeHistoryModal"),mini=document.getElementById("miniPlayer"),miniTitle=document.getElementById("miniTitle"),miniThumb=document.getElementById("miniThumb"),miniProg=document.getElementById("miniProg"),miniPlay=document.getElementById("mpPlay"),miniClose=document.getElementById("mpClose"),ph=document.getElementById("progressHover"),pp=document.getElementById("progressPreview"),ppImg=document.getElementById("previewImg"),ppTime=document.getElementById("previewTime"),seekTime=document.getElementById("seekTime"),openStats=document.getElementById("openStats"),statsModal=document.getElementById("statsModal"),backdrop=document.getElementById("backdrop"),idleOverlay=document.getElementById("idleOverlay"),idleOrbs=document.getElementById("idleOrbs"),konami=document.getElementById("konamiBox");
  let videoId=null;let lastBarPct=null;let pollInt=null;let offlineTimer=null;let lastPresenceTs=Date.now();let isPaused=false;let duration=0;let current=0;let statsEnabled=false;let lastCountedVideoId=null;const OFFLINE_DELAY=2000;const IDLE_AFTER=20000;
  function num(x){return x==null?null:Number(x)}
  function truth(x){return x===true||x==="true"||x===1||x==="1"}
  function setProgress(payload){if(!bar)return;const isLive=truth(payload.isLive);if(isLive){bar.style.width="100%";miniProg.style.width="100%";duration=0;current=0;return}const d=num(payload.duration),c=num(payload.currentTime),p=num(payload.percent);if(typeof d==="number"&&d>0&&typeof c==="number"&&c>=0){const w=Math.max(0,Math.min(100,(c/d)*100));bar.style.width=w+"%";miniProg.style.width=w+"%";lastBarPct=w;duration=d;current=c}else if(typeof p==="number"&&!isNaN(p)){const w=Math.max(0,Math.min(100,p));bar.style.width=w+"%";miniProg.style.width=w+"%";lastBarPct=w}}
  function setStates(payload){const isLive=truth(payload.isLive),isPausedNow=truth(payload.isPaused);live&&live.classList.toggle("active",isLive);pausedEl&&pausedEl.classList.toggle("active",isPausedNow);isPaused=isPausedNow}
  function online(){offline&&offline.classList.remove("visible");card&&card.classList.remove("offline");yt&&(yt.style.display="block")}
  function offlineOn(){offline&&offline.classList.add("visible");card&&card.classList.add("offline")}
  function scheduleOffline(){clearTimeout(offlineTimer);offlineTimer=setTimeout(offlineOn,OFFLINE_DELAY)}
  function cancelOffline(){clearTimeout(offlineTimer);offlineTimer=null;online()}
  function pretty(n){if(typeof n==="string")n=n.replace(/,/g,"");const v=Number(n);return isNaN(v)?"N/A":v.toLocaleString()}
  function renderVideo(payload){videoId=payload.videoId||null;titleEl&&(titleEl.textContent=payload.title||"");chan&&(chan.textContent=payload.channelTitle||"");views&&(views.textContent=pretty(payload.viewCount));likes&&(likes.textContent=pretty(payload.likeCount));pub&&(pub.textContent=payload.publishedAt?new Date(payload.publishedAt).toLocaleDateString():pub.textContent);cat&&(cat.textContent=payload.category||"");desc&&(desc.textContent=payload.description||"");if(thumb){if(payload.thumbnail){thumb.removeAttribute("loading");thumb.src=payload.thumbnail;thumb.style.display="block"}else{thumb.style.display=""}}miniTitle.textContent=payload.title||"";if(payload.thumbnail)miniThumb.src=payload.thumbnail;online();setProgress(payload);setStates(payload);descBtn&&(descBtn.style.display="block");localStorage.setItem("currentVideoTitle",titleEl?titleEl.textContent:"");localStorage.setItem("currentVideoThumbnail",thumb&&thumb.src?thumb.src:"");localStorage.setItem("currentVideoChannel",chan?chan.textContent:"");localStorage.setItem("currentVideoViews",views?views.textContent:"");localStorage.setItem("currentVideoLikes",likes?likes.textContent:"");localStorage.setItem("currentVideoPublished",pub?pub.textContent:"");localStorage.setItem("currentVideoCategory",cat?cat.textContent:"");localStorage.setItem("currentVideoDescription",desc?desc.textContent:"");thumb.classList.remove("thumb-img");void thumb.offsetWidth;thumb.classList.add("thumb-img");document.querySelectorAll(".video-details .animate-in").forEach(x=>{x.classList.remove("active");void x.offsetWidth;x.classList.add("fade-enter","active")});saveHistory(payload)}
  function loadHistory(){const e=localStorage.getItem("npHistory");try{return e?JSON.parse(e):[]}catch{return[]}}
  function saveHistory(payload){const list=loadHistory().filter(x=>x.videoId!==payload.videoId);list.unshift({videoId:payload.videoId||"",title:payload.title||"",thumbnail:payload.thumbnail||"",channelTitle:payload.channelTitle||"",publishedAt:payload.publishedAt||"",category:payload.category||""});const trimmed=list.slice(0,20);localStorage.setItem("npHistory",JSON.stringify(trimmed));renderHistory(trimmed)}
  function histItemView(item){const t=document.createElement("div");t.className="hist-item";t.dataset.videoId=item.videoId;const img=document.createElement("img");img.className="hist-thumb";img.src=item.thumbnail||"";const ti=document.createElement("div");ti.className="hist-title";ti.textContent=item.title||"";const meta=document.createElement("div");meta.className="hist-meta";meta.textContent=item.channelTitle||"";t.appendChild(img);t.appendChild(ti);t.appendChild(meta);t.addEventListener("click",function(){img&&img.scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"});const d={videoId:item.videoId,title:item.title,thumbnail:item.thumbnail,channelTitle:item.channelTitle,viewCount:views?views.textContent:"",likeCount:likes?likes.textContent:"",publishedAt:item.publishedAt,category:item.category,description:desc?desc.textContent:"",duration:0,currentTime:0,isLive:false,isPaused:true};statsEnabled=false;renderVideo(d);closeHistory(false)});return t}
  function renderHistory(arr){histScroller.innerHTML="";arr.slice(0,3).forEach(n=>histScroller.appendChild(histItemView(n)));histMore.disabled=arr.length<=3;histGrid.innerHTML="";arr.slice(3).forEach(n=>histGrid.appendChild(histItemView(n)))}
  function openHistory(){histBackdrop.classList.add("active");histModal.classList.add("active");document.body.classList.add("modal-open")}
  function closeHistory(h=true){if(h){histBackdrop.classList.add("active");histModal.classList.add("active")}else{histBackdrop.classList.remove("active");histModal.classList.remove("active");document.body.classList.remove("modal-open")}}
  function fmt(sec){sec=Math.max(0,Math.floor(sec));const m=Math.floor(sec/60);const s=sec%60;return m+":"+(s<10?"0":"")+s}
  function handleSeek(e){if(!duration||duration<=0){seekTime.style.display="none";pp.style.display="none";return}const rect=e.currentTarget.getBoundingClientRect();const x=Math.min(Math.max(0,e.clientX-rect.left),rect.width);const ratio=x/rect.width;const t=ratio*duration;seekTime.style.left=x+"px";seekTime.style.display="block";seekTime.textContent=fmt(t);pp.style.left=x+"px";if(thumb&&thumb.src){ppImg.src=thumb.src;pp.style.display="block";ppTime.textContent=fmt(t)}}
  ph.addEventListener("mousemove",handleSeek);ph.addEventListener("mouseleave",()=>{seekTime.style.display="none";pp.style.display="none"})
  const ioObserver=new IntersectionObserver(entries=>{entries.forEach(ent=>{mini.classList.toggle("active",!ent.isIntersecting)})},{threshold:0})
  ioObserver.observe(yt)
  miniClose.addEventListener("click",()=>{mini.classList.remove("active")})
  miniPlay.addEventListener("click",()=>{isPaused=!isPaused;pausedEl.classList.toggle("active",isPaused);miniPlay.innerHTML=isPaused?'<i class="fas fa-play"></i>':'<i class="fas fa-pause"></i>'})
  histMore.addEventListener("click",function(){openHistory()})
  histBackdrop.addEventListener("click",function(){closeHistory(false)})
  histClose.addEventListener("click",function(){closeHistory(false)})
  openStats.addEventListener("click",function(){statsModal.classList.add("active");backdrop.classList.add("active");document.body.classList.add("modal-open");renderStats()})
  backdrop.addEventListener("click",function(){statsModal.classList.remove("active");backdrop.classList.remove("active");document.body.classList.remove("modal-open")})
  function getStats(){return JSON.parse(localStorage.getItem("stats")||'{"totalPlays":0,"totalSeconds":0,"channels":{},"videos":{}}')}
  function setStats(s){localStorage.setItem("stats",JSON.stringify(s))}
  function bumpPlay(payload){const st=getStats();st.totalPlays+=1;const ch=payload.channelTitle||"Unknown";st.channels[ch]=(st.channels[ch]||0)+1;const vid=payload.videoId||payload.title||Math.random().toString(36).slice(2);st.videos[vid]=(st.videos[vid]||{title:payload.title||"Untitled",count:0});st.videos[vid].count+=1;setStats(st)}
  function tickTime(){if(!statsEnabled||isPaused)return;const st=getStats();st.totalSeconds+=1;setStats(st)}
  setInterval(tickTime,1000)
  function renderStats(){const st=getStats();document.getElementById("statTotal").textContent=st.totalPlays.toLocaleString();const mins=Math.floor(st.totalSeconds/60);const hrs=Math.floor(mins/60);const rem=mins%60;document.getElementById("statTime").textContent=(hrs>0?hrs+"h ":"")+rem+"m";document.getElementById("statChannels").textContent=Object.keys(st.channels).length.toString();const topC=Object.entries(st.channels).sort((a,b)=>b[1]-a[1]).slice(0,10);const tc=document.getElementById("topChannels");tc.innerHTML="";topC.forEach(([name,count])=>{const it=document.createElement("div");it.className="top-item";const l=document.createElement("div");l.textContent=name;const r=document.createElement("div");r.textContent=count;it.appendChild(l);it.appendChild(r);tc.appendChild(it)});const topV=Object.entries(st.videos).sort((a,b)=>b[1].count-a[1].count).slice(0,10);const tv=document.getElementById("topVideos");tv.innerHTML="";topV.forEach(([id,obj])=>{const it=document.createElement("div");it.className="top-item";const l=document.createElement("div");l.textContent=obj.title;const r=document.createElement("div");r.textContent=obj.count;it.appendChild(l);it.appendChild(r);tv.appendChild(it)})}
  const sock=io()
  sock.on("connect",function(){cancelOffline()})
  sock.on("disconnect",function(){scheduleOffline()})
  sock.on("presenceUpdate",function(payload){
    lastPresenceTs=Date.now()
    if(payload.presenceType==="offline"){scheduleOffline();return}
    cancelOffline()
    if(payload.presenceType==="video"){
      const newVideo = payload.videoId!==videoId
      if(newVideo){layer.classList.add("active");thumbSk.style.display="block";titleSk.style.display="block";lineSk.style.display="block"}
      if(newVideo){renderVideo(payload)}
      else{setProgress(payload);setStates(payload)}
      if(truth(payload.isLive)){statsEnabled=true;if(newVideo && payload.videoId!==lastCountedVideoId){bumpPlay(payload);lastCountedVideoId=payload.videoId}}
      else{statsEnabled=false}
      setTimeout(function(){layer.classList.remove("active");thumbSk.style.display="none";titleSk.style.display="none";lineSk.style.display="none"},180)
    }else if(payload.presenceType==="browsing"){
      titleEl&&(titleEl.textContent=payload.title||titleEl.textContent);if(thumb){if(payload.thumbnail){thumb.src=payload.thumbnail;thumb.style.display="block"}else{thumb.style.display=""}}setStates({isLive:false,isPaused:false});statsEnabled=false
    }
  })
  setTimeout(function(){if(!titleEl||!titleEl.textContent||titleEl.textContent==="Loading…"){const e=localStorage.getItem("currentVideoTitle");if(e&&titleEl)titleEl.textContent=e}},0)
  function idleTick(){const idle=Date.now()-lastPresenceTs>IDLE_AFTER && !live.classList.contains("active") && !thumb.src;idleOverlay.classList.toggle("active",idle)}
  setInterval(idleTick,1000)
  function seedOrbs(){idleOrbs.innerHTML="";for(let i=0;i<24;i++){const s=document.createElement("span");const x=Math.random()*100;const y=Math.random()*100;const delay=(Math.random()*8).toFixed(2);const dur=(10+Math.random()*10).toFixed(2);s.style.left=x+"%";s.style.top=y+"%";s.style.animationDuration=dur+"s";s.style.animationDelay="-"+delay+"s";idleOrbs.appendChild(s)}}
  seedOrbs()
  const code=[38,38,40,40,37,39,37,39,66,65];let pos=0;window.addEventListener("keydown",function(e){if(e.keyCode===code[pos]){pos++;if(pos===code.length){konami.classList.add("active");setTimeout(()=>konami.classList.remove("active"),3000);pos=0}}else{pos=0}})
})
</script>

<script>
document.addEventListener("DOMContentLoaded",function(){const canvas=document.getElementById("soundWaveCanvas");if(!canvas)return;const ctx=canvas.getContext("2d");const cell=20;const glyphs=["0","1"];const words=["Hatsune Miku","Digital Diva","CV01","39"];let cols=0;let y=[],speed=[],hold=[],last=[];function resize(){canvas.width=window.innerWidth;canvas.height=window.innerHeight;cols=Math.floor(canvas.width/cell);y=new Array(cols).fill(0);speed=Array.from({length:cols},()=>Math.random()*0.5+0.5);hold=new Array(cols).fill(0);last=new Array(cols).fill("0")}function rgba(hex,a){const r=parseInt(hex.slice(1,3),16),g=parseInt(hex.slice(3,5),16),b=parseInt(hex.slice(5,7),16);return`rgba(${r}, ${g}, ${b}, ${a})`}resize();window.addEventListener("resize",resize);const palette=["#00C6FF","#FF4081"];function draw(){ctx.fillStyle="rgba(0,0,0,0.05)";ctx.fillRect(0,0,canvas.width,canvas.height);ctx.font=`${cell}px monospace`;ctx.shadowColor="rgba(0,0,0,0.8)";ctx.shadowBlur=4;const trail=6;for(let c=0;c<cols;c++){let ch;if(hold[c]>0){ch=last[c];hold[c]--}else if(Math.random()<0.02){ch=words[Math.floor(Math.random()*words.length)];hold[c]=Math.max(2,Math.ceil(ch.length*3));last[c]=ch}else{ch=glyphs[Math.floor(Math.random()*glyphs.length)];last[c]=ch}const x=c*cell;const py=Math.floor(y[c])*cell;ctx.fillStyle=palette[c%palette.length];ctx.fillText(ch,x,py);for(let t=1;t<=trail;t++){const ty=py-t*cell;if(ty<0)break;const fade=1-t/(trail+1);ctx.fillStyle=rgba(palette[c%palette.length],fade*0.9);ctx.fillText(glyphs[Math.floor(Math.random()*glyphs.length)],x,ty)}if(py>canvas.height&&Math.random()>0.975){y[c]=0;speed[c]=Math.random()*0.1+0.1;hold[c]=0;last[c]="0"}y[c]+=speed[c]}requestAnimationFrame(draw)}requestAnimationFrame(draw)})
</script>

<script>
document.addEventListener("DOMContentLoaded",function(){function send(){fetch("/track-visitor",{method:"POST",keepalive:true}).catch(()=>{})}send();document.addEventListener("visibilitychange",function(){if(document.visibilityState==="hidden"){navigator.sendBeacon&&navigator.sendBeacon("/track-visitor")}})})
</script>
